/*
    http://www.JSON.org/json2.js
    2011-10-19

    Public Domain.

    NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.

    See http://www.JSON.org/js.html


    This code should be minified before deployment.
    See http://javascript.crockford.com/jsmin.html

    USE YOUR OWN COPY. IT IS EXTREMELY UNWISE TO LOAD CODE FROM SERVERS YOU DO
    NOT CONTROL.


    This file creates a global JSON object containing two methods: stringify
    and parse.

        JSON.stringify(value, replacer, space)
            value       any JavaScript value, usually an object or array.

            replacer    an optional parameter that determines how object
                        values are stringified for objects. It can be a
                        function or an array of strings.

            space       an optional parameter that specifies the indentation
                        of nested structures. If it is omitted, the text will
                        be packed without extra whitespace. If it is a number,
                        it will specify the number of spaces to indent at each
                        level. If it is a string (such as '\t' or '&nbsp;'),
                        it contains the characters used to indent at each level.

            This method produces a JSON text from a JavaScript value.

            When an object value is found, if the object contains a toJSON
            method, its toJSON method will be called and the result will be
            stringified. A toJSON method does not serialize: it returns the
            value represented by the name/value pair that should be serialized,
            or undefined if nothing should be serialized. The toJSON method
            will be passed the key associated with the value, and this will be
            bound to the value

            For example, this would serialize Dates as ISO strings.

                Date.prototype.toJSON = function (key) {
                    function f(n) {
                        // Format integers to have at least two digits.
                        return n < 10 ? '0' + n : n;
                    }

                    return this.getUTCFullYear()   + '-' +
                         f(this.getUTCMonth() + 1) + '-' +
                         f(this.getUTCDate())      + 'T' +
                         f(this.getUTCHours())     + ':' +
                         f(this.getUTCMinutes())   + ':' +
                         f(this.getUTCSeconds())   + 'Z';
                };

            You can provide an optional replacer method. It will be passed the
            key and value of each member, with this bound to the containing
            object. The value that is returned from your method will be
            serialized. If your method returns undefined, then the member will
            be excluded from the serialization.

            If the replacer parameter is an array of strings, then it will be
            used to select the members to be serialized. It filters the results
            such that only members with keys listed in the replacer array are
            stringified.

            Values that do not have JSON representations, such as undefined or
            functions, will not be serialized. Such values in objects will be
            dropped; in arrays they will be replaced with null. You can use
            a replacer function to replace those with JSON values.
            JSON.stringify(undefined) returns undefined.

            The optional space parameter produces a stringification of the
            value that is filled with line breaks and indentation to make it
            easier to read.

            If the space parameter is a non-empty string, then that string will
            be used for indentation. If the space parameter is a number, then
            the indentation will be that many spaces.

            Example:

            text = JSON.stringify(['e', {pluribus: 'unum'}]);
            // text is '["e",{"pluribus":"unum"}]'


            text = JSON.stringify(['e', {pluribus: 'unum'}], null, '\t');
            // text is '[\n\t"e",\n\t{\n\t\t"pluribus": "unum"\n\t}\n]'

            text = JSON.stringify([new Date()], function (key, value) {
                return this[key] instanceof Date ?
                    'Date(' + this[key] + ')' : value;
            });
            // text is '["Date(---current time---)"]'


        JSON.parse(text, reviver)
            This method parses a JSON text to produce an object or array.
            It can throw a SyntaxError exception.

            The optional reviver parameter is a function that can filter and
            transform the results. It receives each of the keys and values,
            and its return value is used instead of the original value.
            If it returns what it received, then the structure is not modified.
            If it returns undefined then the member is deleted.

            Example:

            // Parse the text. Values that look like ISO date strings will
            // be converted to Date objects.

            myData = JSON.parse(text, function (key, value) {
                var a;
                if (typeof value === 'string') {
                    a =
/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(value);
                    if (a) {
                        return new Date(Date.UTC(+a[1], +a[2] - 1, +a[3], +a[4],
                            +a[5], +a[6]));
                    }
                }
                return value;
            });

            myData = JSON.parse('["Date(09/09/2001)"]', function (key, value) {
                var d;
                if (typeof value === 'string' &&
                        value.slice(0, 5) === 'Date(' &&
                        value.slice(-1) === ')') {
                    d = new Date(value.slice(5, -1));
                    if (d) {
                        return d;
                    }
                }
                return value;
            });


    This is a reference implementation. You are free to copy, modify, or
    redistribute.
*/
/*jslint evil: true, regexp: true */
/*members "", "\b", "\t", "\n", "\f", "\r", "\"", JSON, "\\", apply,
    call, charCodeAt, getUTCDate, getUTCFullYear, getUTCHours,
    getUTCMinutes, getUTCMonth, getUTCSeconds, hasOwnProperty, join,
    lastIndex, length, parse, prototype, push, replace, slice, stringify,
    test, toJSON, toString, valueOf
*/
// Create a JSON object only if one does not already exist. We create the
// methods in a closure to avoid creating global variables.
function numberWords(e){return e>30?"quite a few":e<0?"impossibly few":(words=["zero","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen","twenty","twenty one","twenty two","twenty three","twenty four","twenty five","twenty six","twenty seven","twenty eight","twenty nine","thirty"],words[e])}function pretty_date(e){var t=(new Date-new Date(e))/1e3,n="ago",r=1;t<0&&(t=Math.abs(t),n="from now",r=2);var i=0,s;while(s=time_formats[i++])if(t<s[0])return typeof s[2]=="string"?s[r]:numberWords(Math.floor(t/s[2]))+" "+s[1]+" "+n;return e}var JSON;JSON||(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(e,t){function n(t,n){var i=t.nodeName.toLowerCase();if("area"===i){var s=t.parentNode,o=s.name,u;return!t.href||!o||s.nodeName.toLowerCase()!=="map"?!1:(u=e("img[usemap=#"+o+"]")[0],!!u&&r(u))}return(/input|select|textarea|button|object/.test(i)?!t.disabled:"a"==i?t.href||n:n)&&r(t)}function r(t){return!e(t).parents().andSelf().filter(function(){return e.curCSS(this,"visibility")==="hidden"||e.expr.filters.hidden(this)}).length}e.ui=e.ui||{};if(e.ui.version)return;e.extend(e.ui,{version:"@VERSION",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),e.fn.extend({propAttr:e.fn.prop||e.fn.attr,_focus:e.fn.focus,focus:function(t,n){return typeof t=="number"?this.each(function(){var r=this;setTimeout(function(){e(r).focus(),n&&n.call(r)},t)}):this._focus.apply(this,arguments)},scrollParent:function(){var t;return e.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?t=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.curCSS(this,"position",1))&&/(auto|scroll)/.test(e.curCSS(this,"overflow",1)+e.curCSS(this,"overflow-y",1)+e.curCSS(this,"overflow-x",1))}).eq(0):t=this.parents().filter(function(){return/(auto|scroll)/.test(e.curCSS(this,"overflow",1)+e.curCSS(this,"overflow-y",1)+e.curCSS(this,"overflow-x",1))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length){var r=e(this[0]),i,s;while(r.length&&r[0]!==document){i=r.css("position");if(i==="absolute"||i==="relative"||i==="fixed"){s=parseInt(r.css("zIndex"),10);if(!isNaN(s)&&s!==0)return s}r=r.parent()}}return 0},disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.each(["Width","Height"],function(n,r){function u(t,n,r,s){return e.each(i,function(){n-=parseFloat(e.curCSS(t,"padding"+this,!0))||0,r&&(n-=parseFloat(e.curCSS(t,"border"+this+"Width",!0))||0),s&&(n-=parseFloat(e.curCSS(t,"margin"+this,!0))||0)}),n}var i=r==="Width"?["Left","Right"]:["Top","Bottom"],s=r.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+r]=function(n){return n===t?o["inner"+r].call(this):this.each(function(){e(this).css(s,u(this,n)+"px")})},e.fn["outer"+r]=function(t,n){return typeof t!="number"?o["outer"+r].call(this,t):this.each(function(){e(this).css(s,u(this,t,!0,n)+"px")})}}),e.extend(e.expr[":"],{data:function(t,n,r){return!!e.data(t,r[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var r=e.attr(t,"tabindex"),i=isNaN(r);return(i||r>=0)&&n(t,!i)}}),e(function(){var t=document.body,n=t.appendChild(n=document.createElement("div"));n.offsetHeight,e.extend(n.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),e.support.minHeight=n.offsetHeight===100,e.support.selectstart="onselectstart"in n,t.removeChild(n).style.display="none"}),e.extend(e.ui,{plugin:{add:function(t,n,r){var i=e.ui[t].prototype;for(var s in r)i.plugins[s]=i.plugins[s]||[],i.plugins[s].push([n,r[s]])},call:function(e,t,n){var r=e.plugins[t];if(!r||!e.element[0].parentNode)return;for(var i=0;i<r.length;i++)e.options[r[i][0]]&&r[i][1].apply(e.element,n)}},contains:function(e,t){return document.compareDocumentPosition?e.compareDocumentPosition(t)&16:e!==t&&e.contains(t)},hasScroll:function(t,n){if(e(t).css("overflow")==="hidden")return!1;var r=n&&n==="left"?"scrollLeft":"scrollTop",i=!1;return t[r]>0?!0:(t[r]=1,i=t[r]>0,t[r]=0,i)},isOverAxis:function(e,t,n){return e>t&&e<t+n},isOver:function(t,n,r,i,s,o){return e.ui.isOverAxis(t,r,s)&&e.ui.isOverAxis(n,i,o)}})}(jQuery),jQuery.effects||function(e,t){function n(t){var n;return t&&t.constructor==Array&&t.length==3?t:(n=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(t))?[parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10)]:(n=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(t))?[parseFloat(n[1])*2.55,parseFloat(n[2])*2.55,parseFloat(n[3])*2.55]:(n=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(t))?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:(n=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(t))?[parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16)]:(n=/rgba\(0, 0, 0, 0\)/.exec(t))?i.transparent:i[e.trim(t).toLowerCase()]}function r(t,r){var i;do{i=e.curCSS(t,r);if(i!=""&&i!="transparent"||e.nodeName(t,"body"))break;r="backgroundColor"}while(t=t.parentNode);return n(i)}function u(){var e=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,t={},n,r;if(e&&e.length&&e[0]&&e[e[0]]){var i=e.length;while(i--)n=e[i],typeof e[n]=="string"&&(r=n.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),t[r]=e[n])}else for(n in e)typeof e[n]=="string"&&(t[n]=e[n]);return t}function a(t){var n,r;for(n in t)r=t[n],(r==null||e.isFunction(r)||n in o||/scrollbar/.test(n)||!/color/i.test(n)&&isNaN(parseFloat(r)))&&delete t[n];return t}function f(e,t){var n={_:0},r;for(r in t)e[r]!=t[r]&&(n[r]=t[r]);return n}function l(t,n,r,i){typeof t=="object"&&(i=n,r=null,n=t,t=n.effect),e.isFunction(n)&&(i=n,r=null,n={});if(typeof n=="number"||e.fx.speeds[n])i=r,r=n,n={};return e.isFunction(r)&&(i=r,r=null),n=n||{},r=r||n.duration,r=e.fx.off?0:typeof r=="number"?r:r in e.fx.speeds?e.fx.speeds[r]:e.fx.speeds._default,i=i||n.complete,[t,n,r,i]}function c(t){return!t||typeof t=="number"||e.fx.speeds[t]?!0:typeof t=="string"&&!e.effects[t]?!0:!1}e.effects={},e.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","borderColor","color","outlineColor"],function(t,i){e.fx.step[i]=function(e){e.colorInit||(e.start=r(e.elem,i),e.end=n(e.end),e.colorInit=!0),e.elem.style[i]="rgb("+Math.max(Math.min(parseInt(e.pos*(e.end[0]-e.start[0])+e.start[0],10),255),0)+","+Math.max(Math.min(parseInt(e.pos*(e.end[1]-e.start[1])+e.start[1],10),255),0)+","+Math.max(Math.min(parseInt(e.pos*(e.end[2]-e.start[2])+e.start[2],10),255),0)+")"}});var i={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]},s=["add","remove","toggle"],o={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.effects.animateClass=function(t,n,r,i){return e.isFunction(r)&&(i=r,r=null),this.queue(function(){var o=e(this),l=o.attr("style")||" ",c=a(u.call(this)),h,p=o.attr("class")||"";e.each(s,function(e,n){t[n]&&o[n+"Class"](t[n])}),h=a(u.call(this)),o.attr("class",p),o.animate(f(c,h),{queue:!1,duration:n,easing:r,complete:function(){e.each(s,function(e,n){t[n]&&o[n+"Class"](t[n])}),typeof o.attr("style")=="object"?(o.attr("style").cssText="",o.attr("style").cssText=l):o.attr("style",l),i&&i.apply(this,arguments),e.dequeue(this)}})})},e.fn.extend({_addClass:e.fn.addClass,addClass:function(t,n,r,i){return n?e.effects.animateClass.apply(this,[{add:t},n,r,i]):this._addClass(t)},_removeClass:e.fn.removeClass,removeClass:function(t,n,r,i){return n?e.effects.animateClass.apply(this,[{remove:t},n,r,i]):this._removeClass(t)},_toggleClass:e.fn.toggleClass,toggleClass:function(n,r,i,s,o){return typeof r=="boolean"||r===t?i?e.effects.animateClass.apply(this,[r?{add:n}:{remove:n},i,s,o]):this._toggleClass(n,r):e.effects.animateClass.apply(this,[{toggle:n},r,i,s])},switchClass:function(t,n,r,i,s){return e.effects.animateClass.apply(this,[{add:n,remove:t},r,i,s])}}),e.extend(e.effects,{version:"@VERSION",save:function(e,t){for(var n=0;n<t.length;n++)t[n]!==null&&e.data("ec.storage."+t[n],e[0].style[t[n]])},restore:function(e,t){for(var n=0;n<t.length;n++)t[n]!==null&&e.css(t[n],e.data("ec.storage."+t[n]))},setMode:function(e,t){return t=="toggle"&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var n,r;switch(e[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=e[0]/t.height}switch(e[1]){case"left":r=0;break;case"center":r=.5;break;case"right":r=1;break;default:r=e[1]/t.width}return{x:r,y:n}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var n={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},r=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),i=document.activeElement;return t.wrap(r),(t[0]===i||e.contains(t[0],i))&&e(i).focus(),r=t.parent(),t.css("position")=="static"?(r.css({position:"relative"}),t.css({position:"relative"})):(e.extend(n,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,r){n[r]=t.css(r),isNaN(parseInt(n[r],10))&&(n[r]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),r.css(n).show()},removeWrapper:function(t){var n,r=document.activeElement;return t.parent().is(".ui-effects-wrapper")?(n=t.parent().replaceWith(t),(t[0]===r||e.contains(t[0],r))&&e(r).focus(),n):t},setTransition:function(t,n,r,i){return i=i||{},e.each(n,function(e,n){var s=t.cssUnit(n);s[0]>0&&(i[n]=s[0]*r+s[1])}),i}}),e.fn.extend({effect:function(t,n,r,i){var s=l.apply(this,arguments),o={options:s[1],duration:s[2],callback:s[3]},u=o.options.mode,a=e.effects[t];return e.fx.off||!a?u?this[u](o.duration,o.callback):this.each(function(){o.callback&&o.callback.call(this)}):a.call(this,o)},_show:e.fn.show,show:function(e){if(c(e))return this._show.apply(this,arguments);var t=l.apply(this,arguments);return t[1].mode="show",this.effect.apply(this,t)},_hide:e.fn.hide,hide:function(e){if(c(e))return this._hide.apply(this,arguments);var t=l.apply(this,arguments);return t[1].mode="hide",this.effect.apply(this,t)},__toggle:e.fn.toggle,toggle:function(t){if(c(t)||typeof t=="boolean"||e.isFunction(t))return this.__toggle.apply(this,arguments);var n=l.apply(this,arguments);return n[1].mode="toggle",this.effect.apply(this,n)},cssUnit:function(t){var n=this.css(t),r=[];return e.each(["em","px","%","pt"],function(e,t){n.indexOf(t)>0&&(r=[parseFloat(n),t])}),r}}),e.easing.jswing=e.easing.swing,e.extend(e.easing,{def:"easeOutQuad",swing:function(t,n,r,i,s){return e.easing[e.easing.def](t,n,r,i,s)},easeInQuad:function(e,t,n,r,i){return r*(t/=i)*t+n},easeOutQuad:function(e,t,n,r,i){return-r*(t/=i)*(t-2)+n},easeInOutQuad:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t+n:-r/2*(--t*(t-2)-1)+n},easeInCubic:function(e,t,n,r,i){return r*(t/=i)*t*t+n},easeOutCubic:function(e,t,n,r,i){return r*((t=t/i-1)*t*t+1)+n},easeInOutCubic:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t*t+n:r/2*((t-=2)*t*t+2)+n},easeInQuart:function(e,t,n,r,i){return r*(t/=i)*t*t*t+n},easeOutQuart:function(e,t,n,r,i){return-r*((t=t/i-1)*t*t*t-1)+n},easeInOutQuart:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t*t*t+n:-r/2*((t-=2)*t*t*t-2)+n},easeInQuint:function(e,t,n,r,i){return r*(t/=i)*t*t*t*t+n},easeOutQuint:function(e,t,n,r,i){return r*((t=t/i-1)*t*t*t*t+1)+n},easeInOutQuint:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t*t*t*t+n:r/2*((t-=2)*t*t*t*t+2)+n},easeInSine:function(e,t,n,r,i){return-r*Math.cos(t/i*(Math.PI/2))+r+n},easeOutSine:function(e,t,n,r,i){return r*Math.sin(t/i*(Math.PI/2))+n},easeInOutSine:function(e,t,n,r,i){return-r/2*(Math.cos(Math.PI*t/i)-1)+n},easeInExpo:function(e,t,n,r,i){return t==0?n:r*Math.pow(2,10*(t/i-1))+n},easeOutExpo:function(e,t,n,r,i){return t==i?n+r:r*(-Math.pow(2,-10*t/i)+1)+n},easeInOutExpo:function(e,t,n,r,i){return t==0?n:t==i?n+r:(t/=i/2)<1?r/2*Math.pow(2,10*(t-1))+n:r/2*(-Math.pow(2,-10*--t)+2)+n},easeInCirc:function(e,t,n,r,i){return-r*(Math.sqrt(1-(t/=i)*t)-1)+n},easeOutCirc:function(e,t,n,r,i){return r*Math.sqrt(1-(t=t/i-1)*t)+n},easeInOutCirc:function(e,t,n,r,i){return(t/=i/2)<1?-r/2*(Math.sqrt(1-t*t)-1)+n:r/2*(Math.sqrt(1-(t-=2)*t)+1)+n},easeInElastic:function(e,t,n,r,i){var s=1.70158,o=0,u=r;if(t==0)return n;if((t/=i)==1)return n+r;o||(o=i*.3);if(u<Math.abs(r)){u=r;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(r/u);return-(u*Math.pow(2,10*(t-=1))*Math.sin((t*i-s)*2*Math.PI/o))+n},easeOutElastic:function(e,t,n,r,i){var s=1.70158,o=0,u=r;if(t==0)return n;if((t/=i)==1)return n+r;o||(o=i*.3);if(u<Math.abs(r)){u=r;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(r/u);return u*Math.pow(2,-10*t)*Math.sin((t*i-s)*2*Math.PI/o)+r+n},easeInOutElastic:function(e,t,n,r,i){var s=1.70158,o=0,u=r;if(t==0)return n;if((t/=i/2)==2)return n+r;o||(o=i*.3*1.5);if(u<Math.abs(r)){u=r;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(r/u);return t<1?-0.5*u*Math.pow(2,10*(t-=1))*Math.sin((t*i-s)*2*Math.PI/o)+n:u*Math.pow(2,-10*(t-=1))*Math.sin((t*i-s)*2*Math.PI/o)*.5+r+n},easeInBack:function(e,n,r,i,s,o){return o==t&&(o=1.70158),i*(n/=s)*n*((o+1)*n-o)+r},easeOutBack:function(e,n,r,i,s,o){return o==t&&(o=1.70158),i*((n=n/s-1)*n*((o+1)*n+o)+1)+r},easeInOutBack:function(e,n,r,i,s,o){return o==t&&(o=1.70158),(n/=s/2)<1?i/2*n*n*(((o*=1.525)+1)*n-o)+r:i/2*((n-=2)*n*(((o*=1.525)+1)*n+o)+2)+r},easeInBounce:function(t,n,r,i,s){return i-e.easing.easeOutBounce(t,s-n,0,i,s)+r},easeOutBounce:function(e,t,n,r,i){return(t/=i)<1/2.75?r*7.5625*t*t+n:t<2/2.75?r*(7.5625*(t-=1.5/2.75)*t+.75)+n:t<2.5/2.75?r*(7.5625*(t-=2.25/2.75)*t+.9375)+n:r*(7.5625*(t-=2.625/2.75)*t+.984375)+n},easeInOutBounce:function(t,n,r,i,s){return n<s/2?e.easing.easeInBounce(t,n*2,0,i,s)*.5+r:e.easing.easeOutBounce(t,n*2-s,0,i,s)*.5+i*.5+r}})}(jQuery),function(e,t){e.effects.bounce=function(t){return this.queue(function(){var n=e(this),r=["position","top","bottom","left","right"],i=e.effects.setMode(n,t.options.mode||"effect"),s=t.options.direction||"up",u=t.options.distance||20,a=t.options.times||5,f=t.duration||250;/show|hide/.test(i)&&r.push("opacity"),e.effects.save(n,r),n.show(),e.effects.createWrapper(n);var l=s=="up"||s=="down"?"top":"left",c=s=="up"||s=="left"?"pos":"neg",u=t.options.distance||(l=="top"?n.outerHeight({margin:!0})/3:n.outerWidth({margin:!0})/3);i=="show"&&n.css("opacity",0).css(l,c=="pos"?-u:u),i=="hide"&&(u/=a*2),i!="hide"&&a--;if(i=="show"){var h={opacity:1};h[l]=(c=="pos"?"+=":"-=")+u,n.animate(h,f/2,t.options.easing),u/=2,a--}for(var p=0;p<a;p++){var d={},v={};d[l]=(c=="pos"?"-=":"+=")+u,v[l]=(c=="pos"?"+=":"-=")+u,n.animate(d,f/2,t.options.easing).animate(v,f/2,t.options.easing),u=i=="hide"?u*2:u/2}if(i=="hide"){var h={opacity:0};h[l]=(c=="pos"?"-=":"+=")+u,n.animate(h,f/2,t.options.easing,function(){n.hide(),e.effects.restore(n,r),e.effects.removeWrapper(n),t.callback&&t.callback.apply(this,arguments)})}else{var d={},v={};d[l]=(c=="pos"?"-=":"+=")+u,v[l]=(c=="pos"?"+=":"-=")+u,n.animate(d,f/2,t.options.easing).animate(v,f/2,t.options.easing,function(){e.effects.restore(n,r),e.effects.removeWrapper(n),t.callback&&t.callback.apply(this,arguments)})}n.queue("fx",function(){n.dequeue()}),n.dequeue()})}}(jQuery),function(e,t){e.effects.highlight=function(t){return this.queue(function(){var n=e(this),r=["backgroundImage","backgroundColor","opacity"],i=e.effects.setMode(n,t.options.mode||"show"),s={backgroundColor:n.css("backgroundColor")};i=="hide"&&(s.opacity=0),e.effects.save(n,r),n.show().css({backgroundImage:"none",backgroundColor:t.options.color||"#ffff99"}).animate(s,{queue:!1,duration:t.duration,easing:t.options.easing,complete:function(){i=="hide"&&n.hide(),e.effects.restore(n,r),i=="show"&&!e.support.opacity&&this.style.removeAttribute("filter"),t.callback&&t.callback.apply(this,arguments),n.dequeue()}})})}}(jQuery),function(e){"use strict";var t,n,r;typeof window=="undefined"?(t=require("underscore"),n=require("backbone"),r=module.exports=n):(t=window._,n=window.Backbone,r=window),n.Relational={showWarnings:!0},n.Semaphore={_permitsAvailable:null,_permitsUsed:0,acquire:function(){if(this._permitsAvailable&&this._permitsUsed>=this._permitsAvailable)throw new Error("Max permits acquired");this._permitsUsed++},release:function(){if(this._permitsUsed===0)throw new Error("All permits released");this._permitsUsed--},isLocked:function(){return this._permitsUsed>0},setAvailablePermits:function(e){if(this._permitsUsed>e)throw new Error("Available permits cannot be less than used permits");this._permitsAvailable=e}},n.BlockingQueue=function(){this._queue=[]},t.extend(n.BlockingQueue.prototype,n.Semaphore,{_queue:null,add:function(e){this.isBlocked()?this._queue.push(e):e()},process:function(){while(this._queue&&this._queue.length)this._queue.shift()()},block:function(){this.acquire()},unblock:function(){this.release(),this.isBlocked()||this.process()},isBlocked:function(){return this.isLocked()}}),n.Relational.eventQueue=new n.BlockingQueue,n.Store=function(){this._collections=[],this._reverseRelations=[],this._orphanRelations=[],this._subModels=[],this._modelScopes=[r]},t.extend(n.Store.prototype,n.Events,{initializeRelation:function(e,r,i){var s=t.isString(r.type)?n[r.type]||this.getObjectByName(r.type):r.type;s&&s.prototype instanceof n.Relation?new s(e,r,i):n.Relational.showWarnings&&typeof console!="undefined"&&console.warn("Relation=%o; missing or invalid relation type!",r)},addModelScope:function(e){this._modelScopes.push(e)},removeModelScope:function(e){this._modelScopes=t.without(this._modelScopes,e)},addSubModels:function(e,t){this._subModels.push({superModelType:t,subModels:e})},setupSuperModel:function(e){t.find(this._subModels,function(n){return t.find(n.subModels||[],function(t,r){var i=this.getObjectByName(t);if(e===i)return n.superModelType._subModels[r]=e,e._superModel=n.superModelType,e._subModelTypeValue=r,e._subModelTypeAttribute=n.superModelType.prototype.subModelTypeAttribute,!0},this)},this)},addReverseRelation:function(e){var n=t.any(this._reverseRelations,function(n){return t.all(e||[],function(e,t){return e===n[t]})});!n&&e.model&&e.type&&(this._reverseRelations.push(e),this._addRelation(e.model,e),this.retroFitRelation(e))},addOrphanRelation:function(e){var n=t.any(this._orphanRelations,function(n){return t.all(e||[],function(e,t){return e===n[t]})});!n&&e.model&&e.type&&this._orphanRelations.push(e)},processOrphanRelations:function(){t.each(this._orphanRelations.slice(0),function(e){var r=n.Relational.store.getObjectByName(e.relatedModel);r&&(this.initializeRelation(null,e),this._orphanRelations=t.without(this._orphanRelations,e))},this)},_addRelation:function(e,n){e.prototype.relations||(e.prototype.relations=[]),e.prototype.relations.push(n),t.each(e._subModels||[],function(e){this._addRelation(e,n)},this)},retroFitRelation:function(e){var t=this.getCollection(e.model,!1);t&&t.each(function(t){if(!(t instanceof e.model))return;new e.type(t,e)},this)},getCollection:function(e,r){e instanceof n.RelationalModel&&(e=e.constructor);var i=e;while(i._superModel)i=i._superModel;var s=t.findWhere(this._collections,{model:i});return!s&&r!==!1&&(s=this._createCollection(i)),s},getObjectByName:function(n){var r=n.split("."),i=null;return t.find(this._modelScopes,function(n){i=t.reduce(r||[],function(t,n){return t?t[n]:e},n);if(i&&i!==n)return!0},this),i},_createCollection:function(e){var t;return e instanceof n.RelationalModel&&(e=e.constructor),e.prototype instanceof n.RelationalModel&&(t=new n.Collection,t.model=e,this._collections.push(t)),t},resolveIdForItem:function(e,r){var i=t.isString(r)||t.isNumber(r)?r:null;return i===null&&(r instanceof n.RelationalModel?i=r.id:t.isObject(r)&&(i=r[e.prototype.idAttribute])),!i&&i!==0&&(i=null),i},find:function(e,t){var n=this.resolveIdForItem(e,t),r=this.getCollection(e);if(r){var i=r.get(n);if(i instanceof e)return i}return null},register:function(e){var t=this.getCollection(e);if(t){var n=e.collection;t.add(e),this.listenTo(e,"destroy",this.unregister,this),e.collection=n}},checkId:function(e,t){var r=this.getCollection(e),i=r&&r.get(t);if(i&&e!==i)throw n.Relational.showWarnings&&typeof console!="undefined"&&console.warn("Duplicate id! Old RelationalModel=%o, new RelationalModel=%o",i,e),new Error("Cannot instantiate more than one Backbone.RelationalModel with the same id per type!")},update:function(e){var t=this.getCollection(e);t._onModelEvent("change:"+e.idAttribute,e,t),e.trigger("relational:change:id",e,t)},unregister:function(e){this.stopListening(e,"destroy",this.unregister);var t=this.getCollection(e);t&&t.remove(e)},reset:function(){this.stopListening(),this._collections=[],this._subModels=[],this._modelScopes=[r]}}),n.Relational.store=new n.Store,n.Relation=function(e,r,i){this.instance=e,r=t.isObject(r)?r:{},this.reverseRelation=t.defaults(r.reverseRelation||{},this.options.reverseRelation),this.options=t.defaults(r,this.options,n.Relation.prototype.options),this.reverseRelation.type=t.isString(this.reverseRelation.type)?n[this.reverseRelation.type]||n.Relational.store.getObjectByName(this.reverseRelation.type):this.reverseRelation.type,this.key=this.options.key,this.keySource=this.options.keySource||this.key,this.keyDestination=this.options.keyDestination||this.keySource||this.key,this.model=this.options.model||this.instance.constructor,this.relatedModel=this.options.relatedModel,t.isString(this.relatedModel)&&(this.relatedModel=n.Relational.store.getObjectByName(this.relatedModel));if(!this.checkPreconditions())return;!this.options.isAutoRelation&&this.reverseRelation.type&&this.reverseRelation.key&&n.Relational.store.addReverseRelation(t.defaults({isAutoRelation:!0,model:this.relatedModel,relatedModel:this.model,reverseRelation:this.options},this.reverseRelation
));if(e){var s=this.keySource;s!==this.key&&typeof this.instance.get(this.key)=="object"&&(s=this.key),this.setKeyContents(this.instance.get(s)),this.relatedCollection=n.Relational.store.getCollection(this.relatedModel),this.keySource!==this.key&&this.instance.unset(this.keySource,{silent:!0}),this.instance._relations[this.key]=this,this.initialize(i),this.options.autoFetch&&this.instance.fetchRelated(this.key,t.isObject(this.options.autoFetch)?this.options.autoFetch:{}),this.listenTo(this.instance,"destroy",this.destroy).listenTo(this.relatedCollection,"relational:add relational:change:id",this.tryAddRelated).listenTo(this.relatedCollection,"relational:remove",this.removeRelated)}},n.Relation.extend=n.Model.extend,t.extend(n.Relation.prototype,n.Events,n.Semaphore,{options:{createModels:!0,includeInJSON:!0,isAutoRelation:!1,autoFetch:!1,parse:!1},instance:null,key:null,keyContents:null,relatedModel:null,relatedCollection:null,reverseRelation:null,related:null,checkPreconditions:function(){var e=this.instance,r=this.key,i=this.model,s=this.relatedModel,o=n.Relational.showWarnings&&typeof console!="undefined";if(!i||!r||!s)return o&&console.warn("Relation=%o: missing model, key or relatedModel (%o, %o, %o).",this,i,r,s),!1;if(i.prototype instanceof n.RelationalModel){if(s.prototype instanceof n.RelationalModel){if(this instanceof n.HasMany&&this.reverseRelation.type===n.HasMany)return o&&console.warn("Relation=%o: relation is a HasMany, and the reverseRelation is HasMany as well.",this),!1;if(e&&t.keys(e._relations).length){var u=t.find(e._relations,function(e){return e.key===r},this);if(u)return o&&console.warn("Cannot create relation=%o on %o for model=%o: already taken by relation=%o.",this,r,e,u),!1}return!0}return o&&console.warn("Relation=%o: relatedModel does not inherit from Backbone.RelationalModel (%o).",this,s),!1}return o&&console.warn("Relation=%o: model does not inherit from Backbone.RelationalModel (%o).",this,e),!1},setRelated:function(e){this.related=e,this.instance.acquire(),this.instance.attributes[this.key]=e,this.instance.release()},_isReverseRelation:function(e){return e.instance instanceof this.relatedModel&&this.reverseRelation.key===e.key&&this.key===e.reverseRelation.key},getReverseRelations:function(e){var n=[],r=t.isUndefined(e)?this.related&&(this.related.models||[this.related]):[e];return t.each(r||[],function(e){t.each(e.getRelations()||[],function(e){this._isReverseRelation(e)&&n.push(e)},this)},this),n},destroy:function(){this.stopListening(),this instanceof n.HasOne?this.setRelated(null):this instanceof n.HasMany&&this.setRelated(this._prepareCollection()),t.each(this.getReverseRelations(),function(e){e.removeRelated(this.instance)},this)}}),n.HasOne=n.Relation.extend({options:{reverseRelation:{type:"HasMany"}},initialize:function(e){this.listenTo(this.instance,"relational:change:"+this.key,this.onChange);var n=this.findRelated(e);this.setRelated(n),t.each(this.getReverseRelations(),function(t){t.addRelated(this.instance,e)},this)},findRelated:function(e){var n=null;e=t.defaults({parse:this.options.parse},e);if(this.keyContents instanceof this.relatedModel)n=this.keyContents;else if(this.keyContents||this.keyContents===0){var r=t.defaults({create:this.options.createModels},e);n=this.relatedModel.findOrCreate(this.keyContents,r)}return this.related&&(this.keyId=null),n},setKeyContents:function(e){this.keyContents=e,this.keyId=n.Relational.store.resolveIdForItem(this.relatedModel,this.keyContents)},onChange:function(e,r,i){if(this.isLocked())return;this.acquire(),i=i?t.clone(i):{};var s=t.isUndefined(i.__related),o=s?this.related:i.__related;if(s){this.setKeyContents(r);var u=this.findRelated(i);this.setRelated(u)}o&&this.related!==o&&t.each(this.getReverseRelations(o),function(e){e.removeRelated(this.instance,null,i)},this),t.each(this.getReverseRelations(),function(e){e.addRelated(this.instance,i)},this);if(!i.silent&&this.related!==o){var a=this;this.changed=!0,n.Relational.eventQueue.add(function(){a.instance.trigger("change:"+a.key,a.instance,a.related,i,!0),a.changed=!1})}this.release()},tryAddRelated:function(e,t,n){(this.keyId||this.keyId===0)&&e.id===this.keyId&&(this.addRelated(e,n),this.keyId=null)},addRelated:function(e,n){var r=this;e.queue(function(){if(e!==r.related){var i=r.related||null;r.setRelated(e),r.onChange(r.instance,e,t.defaults({__related:i},n))}})},removeRelated:function(e,n,r){if(!this.related)return;if(e===this.related){var i=this.related||null;this.setRelated(null),this.onChange(this.instance,e,t.defaults({__related:i},r))}}}),n.HasMany=n.Relation.extend({collectionType:null,options:{reverseRelation:{type:"HasOne"},collectionType:n.Collection,collectionKey:!0,collectionOptions:{}},initialize:function(e){this.listenTo(this.instance,"relational:change:"+this.key,this.onChange),this.collectionType=this.options.collectionType,t.isString(this.collectionType)&&(this.collectionType=n.Relational.store.getObjectByName(this.collectionType));if(!(this.collectionType===n.Collection||this.collectionType.prototype instanceof n.Collection))throw new Error("`collectionType` must inherit from Backbone.Collection");var r=this.findRelated(e);this.setRelated(r)},_prepareCollection:function(e){this.related&&this.stopListening(this.related);if(!e||!(e instanceof n.Collection)){var r=t.isFunction(this.options.collectionOptions)?this.options.collectionOptions(this.instance):this.options.collectionOptions;e=new this.collectionType(null,r)}e.model=this.relatedModel;if(this.options.collectionKey){var i=this.options.collectionKey===!0?this.options.reverseRelation.key:this.options.collectionKey;e[i]&&e[i]!==this.instance?n.Relational.showWarnings&&typeof console!="undefined"&&console.warn("Relation=%o; collectionKey=%s already exists on collection=%o",this,i,this.options.collectionKey):i&&(e[i]=this.instance)}return this.listenTo(e,"relational:add",this.handleAddition).listenTo(e,"relational:remove",this.handleRemoval).listenTo(e,"relational:reset",this.handleReset),e},findRelated:function(e){var r=null;e=t.defaults({parse:this.options.parse},e);if(this.keyContents instanceof n.Collection)this._prepareCollection(this.keyContents),r=this.keyContents;else{var i=[];t.each(this.keyContents,function(n){if(n instanceof this.relatedModel)var r=n;else r=this.relatedModel.findOrCreate(n,t.extend({merge:!0},e,{create:this.options.createModels}));r&&i.push(r)},this),this.related instanceof n.Collection?r=this.related:r=this._prepareCollection(),r.set(i,t.defaults({merge:!1,parse:!1},e))}return this.keyIds=t.difference(this.keyIds,t.pluck(r.models,"id")),r},setKeyContents:function(e){this.keyContents=e instanceof n.Collection?e:null,this.keyIds=[],!this.keyContents&&(e||e===0)&&(this.keyContents=t.isArray(e)?e:[e],t.each(this.keyContents,function(e){var t=n.Relational.store.resolveIdForItem(this.relatedModel,e);(t||t===0)&&this.keyIds.push(t)},this))},onChange:function(e,r,i){i=i?t.clone(i):{},this.setKeyContents(r),this.changed=!1;var s=this.findRelated(i);this.setRelated(s);if(!i.silent){var o=this;n.Relational.eventQueue.add(function(){o.changed&&(o.instance.trigger("change:"+o.key,o.instance,o.related,i,!0),o.changed=!1)})}},handleAddition:function(e,r,i){i=i?t.clone(i):{},this.changed=!0,t.each(this.getReverseRelations(e),function(e){e.addRelated(this.instance,i)},this);var s=this;!i.silent&&n.Relational.eventQueue.add(function(){s.instance.trigger("add:"+s.key,e,s.related,i)})},handleRemoval:function(e,r,i){i=i?t.clone(i):{},this.changed=!0,t.each(this.getReverseRelations(e),function(e){e.removeRelated(this.instance,null,i)},this);var s=this;!i.silent&&n.Relational.eventQueue.add(function(){s.instance.trigger("remove:"+s.key,e,s.related,i)})},handleReset:function(e,r){var i=this;r=r?t.clone(r):{},!r.silent&&n.Relational.eventQueue.add(function(){i.instance.trigger("reset:"+i.key,i.related,r)})},tryAddRelated:function(e,n,r){var i=t.contains(this.keyIds,e.id);i&&(this.addRelated(e,r),this.keyIds=t.without(this.keyIds,e.id))},addRelated:function(e,n){var r=this;e.queue(function(){r.related&&!r.related.get(e)&&r.related.add(e,t.defaults({parse:!1},n))})},removeRelated:function(e,t,n){this.related.get(e)&&this.related.remove(e,n)}}),n.RelationalModel=n.Model.extend({relations:null,_relations:null,_isInitialized:!1,_deferProcessing:!1,_queue:null,subModelTypeAttribute:"type",subModelTypes:null,constructor:function(e,r){if(r&&r.collection){var i=this,s=this.collection=r.collection;delete r.collection,this._deferProcessing=!0;var o=function(e){e===i&&(i._deferProcessing=!1,i.processQueue(),s.off("relational:add",o))};s.on("relational:add",o),t.defer(function(){o(i)})}n.Relational.store.processOrphanRelations(),this._queue=new n.BlockingQueue,this._queue.block(),n.Relational.eventQueue.block();try{n.Model.apply(this,arguments)}finally{n.Relational.eventQueue.unblock()}},trigger:function(e){if(e.length>5&&e.indexOf("change")===0){var t=this,r=arguments;n.Relational.eventQueue.add(function(){if(!t._isInitialized)return;var i=!0;if(e==="change")i=t.hasChanged();else{var s=e.slice(7),o=t.getRelation(s);o&&(i=r[4]===!0,i?t.changed[s]=r[2]:o.changed||delete t.changed[s])}i&&n.Model.prototype.trigger.apply(t,r)})}else n.Model.prototype.trigger.apply(this,arguments);return this},initializeRelations:function(e){this.acquire(),this._relations={},t.each(this.relations||[],function(t){n.Relational.store.initializeRelation(this,t,e)},this),this._isInitialized=!0,this.release(),this.processQueue()},updateRelations:function(e){this._isInitialized&&!this.isLocked()&&t.each(this._relations,function(t){var n=this.attributes[t.keySource]||this.attributes[t.key];t.related!==n&&this.trigger("relational:change:"+t.key,this,n,e||{})},this)},queue:function(e){this._queue.add(e)},processQueue:function(){this._isInitialized&&!this._deferProcessing&&this._queue.isBlocked()&&this._queue.unblock()},getRelation:function(e){return this._relations[e]},getRelations:function(){return t.values(this._relations)},fetchRelated:function(e,r,i){r=t.extend({update:!0,remove:!1},r);var s,o=[],u=this.getRelation(e),a=u&&(u.keyIds||(u.keyId||u.keyId===0?[u.keyId]:[]));if(i){var f=u.related instanceof n.Collection?u.related.models:[u.related];t.each(f,function(e){(e.id||e.id===0)&&a.push(e.id)})}if(a&&a.length){var l=[],f=t.map(a,function(e){var t=n.Relational.store.find(u.relatedModel,e);if(!t){var i={};i[u.relatedModel.prototype.idAttribute]=e,t=u.relatedModel.findOrCreate(i,r),l.push(t)}return t},this);u.related instanceof n.Collection&&t.isFunction(u.related.url)&&(s=u.related.url(f));if(s&&s!==u.related.url()){var c=t.defaults({error:function(){var e=arguments;t.each(l,function(t){t.trigger("destroy",t,t.collection,r),r.error&&r.error.apply(t,e)})},url:s},r);o=[u.related.fetch(c)]}else o=t.map(f,function(e){var n=t.defaults({error:function(){t.contains(l,e)&&(e.trigger("destroy",e,e.collection,r),r.error&&r.error.apply(e,arguments))}},r);return e.fetch(n)},this)}return o},get:function(r){var i=n.Model.prototype.get.call(this,r);if(!this.dotNotation||r.indexOf(".")===-1)return i;var s=r.split("."),o=t.reduce(s,function(e,t){if(e instanceof n.Model)return n.Model.prototype.get.call(e,t);throw new Error("Attribute must be an instanceof Backbone.Model. Is: "+e+", currentSplit: "+t)},this);if(i!==e&&o!==e)throw new Error("Ambiguous result for '"+r+"'. direct result: "+i+", dotNotation: "+o);return i||o},set:function(e,r,i){n.Relational.eventQueue.block();var s;t.isObject(e)||e==null?(s=e,i=r):(s={},s[e]=r);try{var o=this.id,u=s&&this.idAttribute in s&&s[this.idAttribute];n.Relational.store.checkId(this,u);var a=n.Model.prototype.set.apply(this,arguments);!this._isInitialized&&!this.isLocked()?(this.constructor.initializeModelHierarchy(),n.Relational.store.register(this),this.initializeRelations(i)):u&&u!==o&&n.Relational.store.update(this),s&&this.updateRelations(i)}finally{n.Relational.eventQueue.unblock()}return a},unset:function(e,t){n.Relational.eventQueue.block();var r=n.Model.prototype.unset.apply(this,arguments);return this.updateRelations(t),n.Relational.eventQueue.unblock(),r},clear:function(e){n.Relational.eventQueue.block();var t=n.Model.prototype.clear.apply(this,arguments);return this.updateRelations(e),n.Relational.eventQueue.unblock(),t},clone:function(){var e=t.clone(this.attributes);return t.isUndefined(e[this.idAttribute])||(e[this.idAttribute]=null),t.each(this.getRelations(),function(t){delete e[t.key]}),new this.constructor(e)},toJSON:function(e){if(this.isLocked())return this.id;this.acquire();var r=n.Model.prototype.toJSON.call(this,e);return this.constructor._superModel&&!(this.constructor._subModelTypeAttribute in r)&&(r[this.constructor._subModelTypeAttribute]=this.constructor._subModelTypeValue),t.each(this._relations,function(i){var s=r[i.key],o=i.options.includeInJSON,u=null;o===!0?s&&t.isFunction(s.toJSON)&&(u=s.toJSON(e)):t.isString(o)?(s instanceof n.Collection?u=s.pluck(o):s instanceof n.Model&&(u=s.get(o)),o===i.relatedModel.prototype.idAttribute&&(i instanceof n.HasMany?u=u.concat(i.keyIds):i instanceof n.HasOne&&(u=u||i.keyId))):t.isArray(o)?s instanceof n.Collection?(u=[],s.each(function(e){var n={};t.each(o,function(t){n[t]=e.get(t)}),u.push(n)})):s instanceof n.Model&&(u={},t.each(o,function(e){u[e]=s.get(e)})):delete r[i.key],o&&(r[i.keyDestination]=u),i.keyDestination!==i.key&&delete r[i.key]}),this.release(),r}},{setup:function(e){return this.prototype.relations=(this.prototype.relations||[]).slice(0),this._subModels={},this._superModel=null,this.prototype.hasOwnProperty("subModelTypes")?n.Relational.store.addSubModels(this.prototype.subModelTypes,this):this.prototype.subModelTypes=null,t.each(this.prototype.relations||[],function(e){e.model||(e.model=this);if(e.reverseRelation&&e.model===this){var r=!0;if(t.isString(e.relatedModel)){var i=n.Relational.store.getObjectByName(e.relatedModel);r=i&&i.prototype instanceof n.RelationalModel}r?n.Relational.store.initializeRelation(null,e):t.isString(e.relatedModel)&&n.Relational.store.addOrphanRelation(e)}},this),this},build:function(e,t){var n=this;this.initializeModelHierarchy();if(this._subModels&&this.prototype.subModelTypeAttribute in e){var r=e[this.prototype.subModelTypeAttribute],i=this._subModels[r];i&&(n=i)}return new n(e,t)},initializeModelHierarchy:function(){if(t.isUndefined(this._superModel)||t.isNull(this._superModel)){n.Relational.store.setupSuperModel(this);if(this._superModel&&this._superModel.prototype.relations){var e=t.select(this._superModel.prototype.relations||[],function(e){return!t.any(this.prototype.relations||[],function(t){return e.relatedModel===t.relatedModel&&e.key===t.key},this)},this);this.prototype.relations=e.concat(this.prototype.relations)}else this._superModel=!1}this.prototype.subModelTypes&&t.keys(this.prototype.subModelTypes).length!==t.keys(this._subModels).length&&t.each(this.prototype.subModelTypes||[],function(e){var t=n.Relational.store.getObjectByName(e);t&&t.initializeModelHierarchy()})},findOrCreate:function(e,r){r||(r={});var i=t.isObject(e)&&r.parse&&this.prototype.parse?this.prototype.parse(e):e,s=n.Relational.store.find(this,i);return t.isObject(e)&&(s&&r.merge!==!1?(delete r.collection,s.set(i,r)):!s&&r.create!==!1&&(s=this.build(e,r))),s}}),t.extend(n.RelationalModel.prototype,n.Semaphore),n.Collection.prototype.__prepareModel=n.Collection.prototype._prepareModel,n.Collection.prototype._prepareModel=function(e,t){var r;return e instanceof n.Model?(e.collection||(e.collection=this),r=e):(t||(t={}),t.collection=this,typeof this.model.findOrCreate!="undefined"?r=this.model.findOrCreate(e,t):r=new this.model(e,t),r&&r.isNew()&&!r._validate(e,t)&&(this.trigger("invalid",this,e,t),r=!1)),r};var i=n.Collection.prototype.__set=n.Collection.prototype.set;n.Collection.prototype.set=function(e,r){if(this.model.prototype instanceof n.RelationalModel){r&&r.parse&&(e=this.parse(e,r)),t.isArray(e)||(e=e?[e]:[]);var s=[],o=[];return t.each(e,function(e){e instanceof n.Model||(e=n.Collection.prototype._prepareModel.call(this,e,r)),e&&(o.push(e),!this.get(e)&&!this.get(e.cid)?s.push(e):e.id!=null&&(this._byId[e.id]=e))},this),i.call(this,o,t.defaults({parse:!1},r)),t.each(s,function(e){(this.get(e)||this.get(e.cid))&&this.trigger("relational:add",e,this,r)},this),this}return i.apply(this,arguments)};var s=n.Collection.prototype.__remove=n.Collection.prototype.remove;n.Collection.prototype.remove=function(e,r){if(this.model.prototype instanceof n.RelationalModel){e=t.isArray(e)?e.slice():[e],r||(r={});var i=[];return t.each(e,function(e){e=this.get(e)||this.get(e.cid),e&&i.push(e)},this),i.length&&(s.call(this,i,r),t.each(i,function(e){this.trigger("relational:remove",e,this,r)},this)),this}return s.apply(this,arguments)};var o=n.Collection.prototype.__reset=n.Collection.prototype.reset;n.Collection.prototype.reset=function(e,r){return r=t.extend({merge:!0},r),o.call(this,e,r),this.model.prototype instanceof n.RelationalModel&&this.trigger("relational:reset",this,r),this};var u=n.Collection.prototype.__sort=n.Collection.prototype.sort;n.Collection.prototype.sort=function(e){return u.call(this,e),this.model.prototype instanceof n.RelationalModel&&this.trigger("relational:reset",this,e),this};var a=n.Collection.prototype.__trigger=n.Collection.prototype.trigger;n.Collection.prototype.trigger=function(e){if(this.model.prototype instanceof n.RelationalModel){if(e==="add"||e==="remove"||e==="reset"){var r=this,i=arguments;t.isObject(i[3])&&(i=t.toArray(i),i[3]=t.clone(i[3])),n.Relational.eventQueue.add(function(){a.apply(r,i)})}else a.apply(this,arguments);return this}return a.apply(this,arguments)},n.RelationalModel.extend=function(e,t){var r=n.Model.extend.apply(this,arguments);return r.setup(this),r}}(),Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|aft(er)?|from|hence)/i,subtract:/^(\-|bef(ore)?|ago)/i,yesterday:/^yes(terday)?/i,today:/^t(od(ay)?)?/i,tomorrow:/^tom(orrow)?/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^mn|min(ute)?s?/i,hour:/^h(our)?s?/i,week:/^w(eek)?s?/i,month:/^m(onth)?s?/i,day:/^d(ay)?s?/i,year:/^y(ear)?s?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt|utc)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a(?!u|p)|p)/i},timezones:[{name:"UTC",offset:"-000"},{name:"GMT",offset:"-000"},{name:"EST",offset:"-0500"},{name:"EDT",offset:"-0400"},{name:"CST",offset:"-0600"},{name:"CDT",offset:"-0500"},{name:"MST",offset:"-0700"},{name:"MDT",offset:"-0600"},{name:"PST",offset:"-0800"},{name:"PDT",offset:"-0700"}]},function(){var e=Date,t=e.prototype,n=e.CultureInfo,r=function(e,t){return t||(t=2),("000"+e).slice(t*-1)};t.clearTime=function(){return this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this},t.setTimeToNow=function(){var e=new Date;return this.setHours(e.getHours()),this.setMinutes(e.getMinutes()),this.setSeconds(e.getSeconds()),this.setMilliseconds(e.getMilliseconds()),this},e.today=function(){return(new Date).clearTime()},e.compare=function(e,t){if(isNaN(e)||isNaN(t))throw new Error(e+" - "+t);if(e instanceof Date&&t instanceof Date)return e<t?-1:e>t?1:0;throw new TypeError(e+" - "+t)},e.equals=function(e,t){return e.compareTo(t)===0},e.getDayNumberFromName=function(e){var t=n.dayNames,r=n.abbreviatedDayNames,i=n.shortestDayNames,s=e.toLowerCase();for(var o=0;o<t.length;o++)if(t[o].toLowerCase()==s||r[o].toLowerCase()==s||i[o].toLowerCase()==s)return o;return-1},e.getMonthNumberFromName=function(e){var t=n.monthNames,r=n.abbreviatedMonthNames,i=e.toLowerCase();for(var s=0;s<t.length;s++)if(t[s].toLowerCase()==i||r[s].toLowerCase()==i)return s;return-1},e.isLeapYear=function(e){return e%4===0&&e%100!==0||e%400===0},e.getDaysInMonth=function(t,n){return[31,e.isLeapYear(t)?29:28,31,30,31,30,31,31,30,31,30,31][n]},e.getTimezoneAbbreviation=function(e){var t=n.timezones,r;for(var i=0;i<t.length;i++)if(t[i].offset===e)return t[i].name;return null},e.getTimezoneOffset=function(e){var t=n.timezones,r;for(var i=0;i<t.length;i++)if(t[i].name===e.toUpperCase())return t[i].offset;return null},t.clone=function(){return new Date(this.getTime())},t.compareTo=function(e){return Date.compare(this,e)},t.equals=function(e){return Date.equals(this,e||new Date)},t.between=function(e,t){return this.getTime()>=e.getTime()&&this.getTime()<=t.getTime()},t.isAfter=function(e){return this.compareTo(e||new Date)===1},t.isBefore=function(e){return this.compareTo(e||new Date)===-1},t.isToday=function(){return this.isSameDay(new Date)},t.isSameDay=function(e){return this.clone().clearTime().equals(e.clone().clearTime())},t.addMilliseconds=function(e){return this.setMilliseconds(this.getMilliseconds()+e),this},t.addSeconds=function(e){return this.addMilliseconds(e*1e3)},t.addMinutes=function(e){return this.addMilliseconds(e*6e4)},t.addHours=function(e){return this.addMilliseconds(e*36e5)},t.addDays=function(e){return this.setDate(this.getDate()+e),this},t.addWeeks=function(e){return this.addDays(e*7)},t.addMonths=function(t){var n=this.getDate();return this.setDate(1),this.setMonth(this.getMonth()+t),this.setDate(Math.min(n,e.getDaysInMonth(this.getFullYear(),this.getMonth()))),this},t.addYears=function(e){return this.addMonths(e*12)},t.add=function(e){if(typeof e=="number")return this._orient=e,this;var t=e;return t.milliseconds&&this.addMilliseconds(t.milliseconds),t.seconds&&this.addSeconds(t.seconds),t.minutes&&this.addMinutes(t.minutes),t.hours&&this.addHours(t.hours),t.weeks&&this.addWeeks(t.weeks),t.months&&this.addMonths(t.months),t.years&&this.addYears(t.years),t.days&&this.addDays(t.days),this};var i,s,o;t.getWeek=function(){var e,t,n,r,u,a,f,l,c,h;return i=i?i:this.getFullYear(),s=s?s:this.getMonth()+1,o=o?o:this.getDate(),s<=2?(e=i-1,t=(e/4|0)-(e/100|0)+(e/400|0),n=((e-1)/4|0)-((e-1)/100|0)+((e-1)/400|0),c=t-n,u=0,a=o-1+31*(s-1)):(e=i,t=(e/4|0)-(e/100|0)+(e/400|0),n=((e-1)/4|0)-((e-1)/100|0)+((e-1)/400|0),c=t-n,u=c+1,a=o+(153*(s-3)+2)/5+58+c),f=(e+t)%7,r=(a+f-u)%7,l=a+3-r|0,l<0?h=53-((f-c)/5|0):l>364+c?h=1:h=(l/7|0)+1,i=s=o=null,h},t.getISOWeek=function(){return i=this.getUTCFullYear(),s=this.getUTCMonth()+1,o=this.getUTCDate(),r(this.getWeek())},t.setWeek=function(e){return this.moveToDayOfWeek(1).addWeeks(e-this.getWeek())},e._validate=function(e,t,n,r){if(typeof e=="undefined")return!1;if(typeof e!="number")throw new TypeError(e+" is not a Number.");if(e<t||e>n)throw new RangeError(e+" is not a valid value for "+r+".");return!0},e.validateMillisecond=function(t){return e._validate(t,0,999,"millisecond")},e.validateSecond=function(t){return e._validate(t,0,59,"second")},e.validateMinute=function(t){return e._validate(t,0,59,"minute")},e.validateHour=function(t){return e._validate(t,0,23,"hour")},e.validateDay=function(t,n,r){return e._validate(t,1,e.getDaysInMonth(n,r),"day")},e.validateMonth=function(t){return e._validate(t,0,11,"month")},e.validateYear=function(t){return e._validate(t,0,9999,"year")},t.set=function(t){return e.validateMillisecond(t.millisecond)&&this.addMilliseconds(t.millisecond-this.getMilliseconds()),e.validateSecond(t.second)&&this.addSeconds(t.second-this.getSeconds()),e.validateMinute(t.minute)&&this.addMinutes(t.minute-this.getMinutes()),e.validateHour(t.hour)&&this.addHours(t.hour-this.getHours()),e.validateMonth(t.month)&&this.addMonths(t.month-this.getMonth()),e.validateYear(t.year)&&this.addYears(t.year-this.getFullYear()),e.validateDay(t.day,this.getFullYear(),this.getMonth())&&this.addDays(t.day-this.getDate()),t.timezone&&this.setTimezone(t.timezone),t.timezoneOffset&&this.setTimezoneOffset(t.timezoneOffset),t.week&&e._validate(t.week,0,53,"week")&&this.setWeek(t.week),this},t.moveToFirstDayOfMonth=function(){return this.set({day:1})},t.moveToLastDayOfMonth=function(){return this.set({day:e.getDaysInMonth(this.getFullYear(),this.getMonth())})},t.moveToNthOccurrence=function(e,t){var n=0;if(t>0)n=t-1;else if(t===-1)return this.moveToLastDayOfMonth(),this.getDay()!==e&&this.moveToDayOfWeek(e,-1),this;return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(e,1).addWeeks(n)},t.moveToDayOfWeek=function(e,t){var n=(e-this.getDay()+7*(t||1))%7;return this.addDays(n===0?n+=7*(t||1):n)},t.moveToMonth=function(e,t){var n=(e-this.getMonth()+12*(t||1))%12;return this.addMonths(n===0?n+=12*(t||1):n)},t.getOrdinalNumber=function(){return Math.ceil((this.clone().clearTime()-new Date(this.getFullYear(),0,1))/864e5)+1},t.getTimezone=function(){return e.getTimezoneAbbreviation(this.getUTCOffset())},t.setTimezoneOffset=function(e){var t=this.getTimezoneOffset(),n=Number(e)*-6/10;return this.addMinutes(n-t)},t.setTimezone=function(t){return this.setTimezoneOffset(e.getTimezoneOffset(t))},t.hasDaylightSavingTime=function(){return Date.today().set({month:0,day:1}).getTimezoneOffset()!==Date.today().set({month:6,day:1}).getTimezoneOffset()},t.isDaylightSavingTime=function(){return this.hasDaylightSavingTime()&&(new Date).getTimezoneOffset()===Date.today().set({month:6,day:1}).getTimezoneOffset()},t.getUTCOffset=function(){var e=this.getTimezoneOffset()*-10/6,t;return e<0?(t=(e-1e4).toString(),t.charAt(0)+t.substr(2)):(t=(e+1e4).toString(),"+"+t.substr(1))},t.getElapsed=function(e){return(e||new Date)-this},t.toISOString||(t.toISOString=function(){function e(e){return e<10?"0"+e:e}return'"'+this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+'Z"'}),t._toString=t.toString,t.toString=function(e){var t=this;if(e&&e.length==1){var i=n.formatPatterns;t.t=t.toString;switch(e){case"d":return t.t(i.shortDate);case"D":return t.t(i.longDate);case"F":return t.t(i.fullDateTime);case"m":return t.t(i.monthDay);case"r":return t.t(i.rfc1123);case"s":return t.t(i.sortableDateTime);case"t":return t.t(i.shortTime);case"T":return t.t(i.longTime);case"u":return t.t(i.universalSortableDateTime);case"y":return t.t(i.yearMonth)}}var s=function(e){switch(e*1){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};return e?e.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g,function(e){if(e.charAt(0)==="\\")return e.replace("\\","");t.h=t.getHours;switch(e){case"hh":return r(t.h()<13?t.h()===0?12:t.h():t.h()-12);case"h":return t.h()<13?t.h()===0?12:t.h():t.h()-12;case"HH":return r(t.h());case"H":return t.h();case"mm":return r(t.getMinutes());case"m":return t.getMinutes();case"ss":return r(t.getSeconds());case"s":return t.getSeconds();case"yyyy":return r(t.getFullYear(),4);case"yy":return r(t.getFullYear());case"dddd":return n.dayNames[t.getDay()];case"ddd":return n.abbreviatedDayNames[t.getDay()];case"dd":return r(t.getDate());case"d":return t.getDate();case"MMMM":return n.monthNames[t.getMonth()];case"MMM":return n.abbreviatedMonthNames[t.getMonth()];case"MM":return r(t.getMonth()+1);case"M":return t.getMonth()+1;case"t":return t.h()<12?n.amDesignator.substring(0,1):n.pmDesignator.substring(0,1);case"tt":return t.h()<12?n.amDesignator:n.pmDesignator;case"S":return s(t.getDate());default:return e}}):this._toString()}}(),function(){var e=Date,t=e.prototype,n=e.CultureInfo,r=Number.prototype;t._orient=1,t._nth=null,t._is=!1,t._same=!1,t._isSecond=!1,r._dateElement="day",t.next=function(){return this._orient=1,this},e.next=function(){return e.today().next()},t.last=t.prev=t.previous=function(){return this._orient=-1,this},e.last=e.prev=e.previous=function(){return e.today().last()},t.is=function(){return this._is=!0,this},t.same=function(){return this._same=!0,this._isSecond=!1,this},t.today=function(){return this.same().day()},t.weekday=function(){return this._is?(this._is=!1,!this.is().sat()&&!this.is().sun()):!1},t.at=function(t){return typeof t=="string"?e.parse(this.toString("d")+" "+t):this.set(t)},r.fromNow=r.after=function(e){var t={};return t[this._dateElement]=this,(e?e.clone():new Date).add(t)},r.ago=r.before=function(e){var t={};return t[this._dateElement]=this*-1,(e?e.clone():new Date).add(t)};var i="sunday monday tuesday wednesday thursday friday saturday".split(/\s/),s="january february march april may june july august september october november december".split(/\s/),o="Millisecond Second Minute Hour Day Week Month Year".split(/\s/),u="Milliseconds Seconds Minutes Hours Date Week Month FullYear".split(/\s/),a="final first second third fourth fifth".split(/\s/),f;t.toObject=function(){var e={};for(var t=0;t<o.length;t++)e[o[t].toLowerCase()]=this["get"+u[t]]();return e},e.fromObject=function(e){return e.week=null,Date.today().set(e)};var l=function(t){return function(){if(this._is)return this._is=!1,this.getDay()==t;if(this._nth!==null){this._isSecond&&this.addSeconds(this._orient*-1),this._isSecond=!1;var n=this._nth;this._nth=null;var r=this.clone().moveToLastDayOfMonth();this.moveToNthOccurrence(t,n);if(this>r)throw new RangeError(e.getDayName(t)+" does not occur "+n+" times in the month of "+e.getMonthName(r.getMonth())+" "+r.getFullYear()+".");return this}return this.moveToDayOfWeek(t,this._orient)}},c=function(t){return function(){var r=e.today(),i=t-r.getDay();return t===0&&n.firstDayOfWeek===1&&r.getDay()!==0&&(i+=7),r.addDays(i)}};for(var h=0;h<i.length;h++)e[i[h].toUpperCase()]=e[i[h].toUpperCase().substring(0,3)]=h,e[i[h]]=e[i[h].substring(0,3)]=c(h),t[i[h]]=t[i[h].substring(0,3)]=l(h);var p=function(e){return function(){return this._is?(this._is=!1,this.getMonth()===e):this.moveToMonth(e,this._orient)}},d=function(t){return function(){return e.today().set({month:t,day:1})}};for(var v=0;v<s.length;v++)e[s[v].toUpperCase()]=e[s[v].toUpperCase().substring(0,3)]=v,e[s[v]]=e[s[v].substring(0,3)]=d(v),t[s[v]]=t[s[v].substring(0,3)]=p(v);var m=function(e){return function(){if(this._isSecond)return this._isSecond=!1,this;if(this._same){this._same=this._is=!1;var t=this.toObject(),n=(arguments[0]||new Date).toObject(),r="",i=e.toLowerCase();for(var s=o.length-1;s>-1;s--){r=o[s].toLowerCase();if(t[r]!=n[r])return!1;if(i==r)break}return!0}return e.substring(e.length-1)!="s"&&(e+="s"),this["add"+e](this._orient)}},g=function(e){return function(){return this._dateElement=e,this}};for(var y=0;y<o.length;y++)f=o[y].toLowerCase(),t[f]=t[f+"s"]=m(o[y]),r[f]=r[f+"s"]=g(f);t._ss=m("Second");var b=function(e){return function(t){return this._same?this._ss(arguments[0]):t||t===0?this.moveToNthOccurrence(t,e):(this._nth=e,e!==2||t!==undefined&&t!==null?this:(this._isSecond=!0,this.addSeconds(this._orient)))}};for(var w=0;w<a.length;w++)t[a[w]]=w===0?b(-1):b(w)}(),function(){Date.Parsing={Exception:function(e){this.message="Parse error at '"+e.substring(0,10)+" ...'"}};var e=Date.Parsing,t=e.Operators={rtoken:function(t){return function(n){var i=n.match(t);if(i)return[i[0],n.substring(i[0].length)];throw new e.Exception(n)}},token:function(e){return function(e){return t.rtoken(new RegExp("^s*"+e+"s*"))(e)}},stoken:function(e){return t.rtoken(new RegExp("^"+e))},until:function(e){return function(t){var n=[],r=null;while(t.length){try{r=e.call(this,t)}catch(i){n.push(r[0]),t=r[1];continue}break}return[n,t]}},many:function(e){return function(t){var n=[],r=null;while(t.length){try{r=e.call(this,t)}catch(i){return[n,t]}n.push(r[0]),t=r[1]}return[n,t]}},optional:function(e){return function(t){var n=null;try{n=e.call(this,t)}catch(
r){return[null,t]}return[n[0],n[1]]}},not:function(t){return function(n){try{t.call(this,n)}catch(r){return[null,n]}throw new e.Exception(n)}},ignore:function(e){return e?function(t){var n=null;return n=e.call(this,t),[null,n[1]]}:null},product:function(){var e=arguments[0],n=Array.prototype.slice.call(arguments,1),r=[];for(var i=0;i<e.length;i++)r.push(t.each(e[i],n));return r},cache:function(t){var n={},r=null;return function(i){try{r=n[i]=n[i]||t.call(this,i)}catch(s){r=n[i]=s}if(r instanceof e.Exception)throw r;return r}},any:function(){var t=arguments;return function(n){var r=null;for(var i=0;i<t.length;i++){if(t[i]==null)continue;try{r=t[i].call(this,n)}catch(s){r=null}if(r)return r}throw new e.Exception(n)}},each:function(){var t=arguments;return function(n){var r=[],i=null;for(var s=0;s<t.length;s++){if(t[s]==null)continue;try{i=t[s].call(this,n)}catch(o){throw new e.Exception(n)}r.push(i[0]),n=i[1]}return[r,n]}},all:function(){var e=arguments,t=t;return t.each(t.optional(e))},sequence:function(n,r,i){return r=r||t.rtoken(/^\s*/),i=i||null,n.length==1?n[0]:function(t){var s=null,o=null,u=[];for(var a=0;a<n.length;a++){try{s=n[a].call(this,t)}catch(f){break}u.push(s[0]);try{o=r.call(this,s[1])}catch(l){o=null;break}t=o[1]}if(!s)throw new e.Exception(t);if(o)throw new e.Exception(o[1]);if(i)try{s=i.call(this,s[1])}catch(h){throw new e.Exception(s[1])}return[u,s?s[1]:t]}},between:function(e,n,i){i=i||e;var s=t.each(t.ignore(e),n,t.ignore(i));return function(e){var t=s.call(this,e);return[[t[0][0],r[0][2]],t[1]]}},list:function(e,n,r){return n=n||t.rtoken(/^\s*/),r=r||null,e instanceof Array?t.each(t.product(e.slice(0,-1),t.ignore(n)),e.slice(-1),t.ignore(r)):t.each(t.many(t.each(e,t.ignore(n))),px,t.ignore(r))},set:function(n,r,i){return r=r||t.rtoken(/^\s*/),i=i||null,function(s){var o=null,u=null,a=null,f=null,l=[[],s],h=!1;for(var p=0;p<n.length;p++){a=null,u=null,o=null,h=n.length==1;try{o=n[p].call(this,s)}catch(v){continue}f=[[o[0]],o[1]];if(o[1].length>0&&!h)try{a=r.call(this,o[1])}catch(m){h=!0}else h=!0;!h&&a[1].length===0&&(h=!0);if(!h){var g=[];for(var y=0;y<n.length;y++)p!=y&&g.push(n[y]);u=t.set(g,r).call(this,a[1]),u[0].length>0&&(f[0]=f[0].concat(u[0]),f[1]=u[1])}f[1].length<l[1].length&&(l=f);if(l[1].length===0)break}if(l[0].length===0)return l;if(i){try{a=i.call(this,l[1])}catch(b){throw new e.Exception(l[1])}l[1]=a[1]}return l}},forward:function(e,t){return function(n){return e[t].call(this,n)}},replace:function(e,t){return function(n){var r=e.call(this,n);return[t,r[1]]}},process:function(e,t){return function(n){var r=e.call(this,n);return[t.call(this,r[0]),r[1]]}},min:function(t,n){return function(r){var i=n.call(this,r);if(i[0].length<t)throw new e.Exception(r);return i}}},n=function(e){return function(){var t=null,n=[];arguments.length>1?t=Array.prototype.slice.call(arguments):arguments[0]instanceof Array&&(t=arguments[0]);if(!t)return e.apply(null,arguments);for(var r=0,i=t.shift();r<i.length;r++)return t.unshift(i[r]),n.push(e.apply(null,t)),t.shift(),n}},i="optional not ignore cache".split(/\s/);for(var s=0;s<i.length;s++)t[i[s]]=n(t[i[s]]);var o=function(e){return function(){return arguments[0]instanceof Array?e.apply(null,arguments[0]):e.apply(null,arguments)}},u="each any all".split(/\s/);for(var a=0;a<u.length;a++)t[u[a]]=o(t[u[a]])}(),function(){var e=Date,t=e.prototype,n=e.CultureInfo,r=function(e){var t=[];for(var n=0;n<e.length;n++)e[n]instanceof Array?t=t.concat(r(e[n])):e[n]&&t.push(e[n]);return t};e.Grammar={},e.Translator={hour:function(e){return function(){this.hour=Number(e)}},minute:function(e){return function(){this.minute=Number(e)}},second:function(e){return function(){this.second=Number(e)}},meridian:function(e){return function(){this.meridian=e.slice(0,1).toLowerCase()}},timezone:function(e){return function(){var t=e.replace(/[^\d\+\-]/g,"");t.length?this.timezoneOffset=Number(t):this.timezone=e.toLowerCase()}},day:function(e){var t=e[0];return function(){this.day=Number(t.match(/\d+/)[0])}},month:function(e){return function(){this.month=e.length==3?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(e)/4:Number(e)-1}},year:function(e){return function(){var t=Number(e);this.year=e.length>2?t:t+(t+2e3<n.twoDigitYearMax?2e3:1900)}},rday:function(e){return function(){switch(e){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0,this.now=!0}}},finishExact:function(t){t=t instanceof Array?t:[t];for(var n=0;n<t.length;n++)t[n]&&t[n].call(this);var r=new Date;(this.hour||this.minute)&&!this.month&&!this.year&&!this.day&&(this.day=r.getDate()),this.year||(this.year=r.getFullYear()),!this.month&&this.month!==0&&(this.month=r.getMonth()),this.day||(this.day=1),this.hour||(this.hour=0),this.minute||(this.minute=0),this.second||(this.second=0),this.meridian&&this.hour&&(this.meridian=="p"&&this.hour<12?this.hour=this.hour+12:this.meridian=="a"&&this.hour==12&&(this.hour=0));if(this.day>e.getDaysInMonth(this.year,this.month))throw new RangeError(this.day+" is not a valid value for days.");var i=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);return this.timezone?i.set({timezone:this.timezone}):this.timezoneOffset&&i.set({timezoneOffset:this.timezoneOffset}),i},finish:function(t){t=t instanceof Array?r(t):[t];if(t.length===0)return null;for(var n=0;n<t.length;n++)typeof t[n]=="function"&&t[n].call(this);var i=e.today();if(this.now&&!this.unit&&!this.operator)return new Date;this.now&&(i=new Date);var s=!!(this.days&&this.days!==null||this.orient||this.operator),o,u,a;a=this.orient=="past"||this.operator=="subtract"?-1:1,!this.now&&"hour minute second".indexOf(this.unit)!=-1&&i.setTimeToNow(),(this.month||this.month===0)&&"year day hour minute second".indexOf(this.unit)!=-1&&(this.value=this.month+1,this.month=null,s=!0);if(!s&&this.weekday&&!this.day&&!this.days){var f=Date[this.weekday]();this.day=f.getDate(),this.month||(this.month=f.getMonth()),this.year=f.getFullYear()}s&&this.weekday&&this.unit!="month"&&(this.unit="day",o=e.getDayNumberFromName(this.weekday)-i.getDay(),u=7,this.days=o?(o+a*u)%u:a*u),this.month&&this.unit=="day"&&this.operator&&(this.value=this.month+1,this.month=null),this.value!=null&&this.month!=null&&this.year!=null&&(this.day=this.value*1),this.month&&!this.day&&this.value&&(i.set({day:this.value*1}),s||(this.day=this.value*1)),!this.month&&this.value&&this.unit=="month"&&!this.now&&(this.month=this.value,s=!0),s&&(this.month||this.month===0)&&this.unit!="year"&&(this.unit="month",o=this.month-i.getMonth(),u=12,this.months=o?(o+a*u)%u:a*u,this.month=null),this.unit||(this.unit="day");if(!this.value&&this.operator&&this.operator!==null&&this[this.unit+"s"]&&this[this.unit+"s"]!==null)this[this.unit+"s"]=this[this.unit+"s"]+(this.operator=="add"?1:-1)+(this.value||0)*a;else if(this[this.unit+"s"]==null||this.operator!=null)this.value||(this.value=1),this[this.unit+"s"]=this.value*a;this.meridian&&this.hour&&(this.meridian=="p"&&this.hour<12?this.hour=this.hour+12:this.meridian=="a"&&this.hour==12&&(this.hour=0));if(this.weekday&&!this.day&&!this.days){var f=Date[this.weekday]();this.day=f.getDate(),f.getMonth()!==i.getMonth()&&(this.month=f.getMonth())}return(this.month||this.month===0)&&!this.day&&(this.day=1),!this.orient&&!this.operator&&this.unit=="week"&&this.value&&!this.day&&!this.month?Date.today().setWeek(this.value):(s&&this.timezone&&this.day&&this.days&&(this.day=this.days),s?i.add(this):i.set(this))}};var i=e.Parsing.Operators,s=e.Grammar,o=e.Translator,u;s.datePartDelimiter=i.rtoken(/^([\s\-\.\,\/\x27]+)/),s.timePartDelimiter=i.stoken(":"),s.whiteSpace=i.rtoken(/^\s*/),s.generalDelimiter=i.rtoken(/^(([\s\,]|at|@|on)+)/);var a={};s.ctoken=function(e){var t=a[e];if(!t){var r=n.regexPatterns,s=e.split(/\s+/),o=[];for(var u=0;u<s.length;u++)o.push(i.replace(i.rtoken(r[s[u]]),s[u]));t=a[e]=i.any.apply(null,o)}return t},s.ctoken2=function(e){return i.rtoken(n.regexPatterns[e])},s.h=i.cache(i.process(i.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),o.hour)),s.hh=i.cache(i.process(i.rtoken(/^(0[0-9]|1[0-2])/),o.hour)),s.H=i.cache(i.process(i.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),o.hour)),s.HH=i.cache(i.process(i.rtoken(/^([0-1][0-9]|2[0-3])/),o.hour)),s.m=i.cache(i.process(i.rtoken(/^([0-5][0-9]|[0-9])/),o.minute)),s.mm=i.cache(i.process(i.rtoken(/^[0-5][0-9]/),o.minute)),s.s=i.cache(i.process(i.rtoken(/^([0-5][0-9]|[0-9])/),o.second)),s.ss=i.cache(i.process(i.rtoken(/^[0-5][0-9]/),o.second)),s.hms=i.cache(i.sequence([s.H,s.m,s.s],s.timePartDelimiter)),s.t=i.cache(i.process(s.ctoken2("shortMeridian"),o.meridian)),s.tt=i.cache(i.process(s.ctoken2("longMeridian"),o.meridian)),s.z=i.cache(i.process(i.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),o.timezone)),s.zz=i.cache(i.process(i.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),o.timezone)),s.zzz=i.cache(i.process(s.ctoken2("timezone"),o.timezone)),s.timeSuffix=i.each(i.ignore(s.whiteSpace),i.set([s.tt,s.zzz])),s.time=i.each(i.optional(i.ignore(i.stoken("T"))),s.hms,s.timeSuffix),s.d=i.cache(i.process(i.each(i.rtoken(/^([0-2]\d|3[0-1]|\d)/),i.optional(s.ctoken2("ordinalSuffix"))),o.day)),s.dd=i.cache(i.process(i.each(i.rtoken(/^([0-2]\d|3[0-1])/),i.optional(s.ctoken2("ordinalSuffix"))),o.day)),s.ddd=s.dddd=i.cache(i.process(s.ctoken("sun mon tue wed thu fri sat"),function(e){return function(){this.weekday=e}})),s.M=i.cache(i.process(i.rtoken(/^(1[0-2]|0\d|\d)/),o.month)),s.MM=i.cache(i.process(i.rtoken(/^(1[0-2]|0\d)/),o.month)),s.MMM=s.MMMM=i.cache(i.process(s.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),o.month)),s.y=i.cache(i.process(i.rtoken(/^(\d\d?)/),o.year)),s.yy=i.cache(i.process(i.rtoken(/^(\d\d)/),o.year)),s.yyy=i.cache(i.process(i.rtoken(/^(\d\d?\d?\d?)/),o.year)),s.yyyy=i.cache(i.process(i.rtoken(/^(\d\d\d\d)/),o.year)),u=function(){return i.each(i.any.apply(null,arguments),i.not(s.ctoken2("timeContext")))},s.day=u(s.d,s.dd),s.month=u(s.M,s.MMM),s.year=u(s.yyyy,s.yy),s.orientation=i.process(s.ctoken("past future"),function(e){return function(){this.orient=e}}),s.operator=i.process(s.ctoken("add subtract"),function(e){return function(){this.operator=e}}),s.rday=i.process(s.ctoken("yesterday tomorrow today now"),o.rday),s.unit=i.process(s.ctoken("second minute hour day week month year"),function(e){return function(){this.unit=e}}),s.value=i.process(i.rtoken(/^\d\d?(st|nd|rd|th)?/),function(e){return function(){this.value=e.replace(/\D/g,"")}}),s.expression=i.set([s.rday,s.operator,s.value,s.unit,s.orientation,s.ddd,s.MMM]),u=function(){return i.set(arguments,s.datePartDelimiter)},s.mdy=u(s.ddd,s.month,s.day,s.year),s.ymd=u(s.ddd,s.year,s.month,s.day),s.dmy=u(s.ddd,s.day,s.month,s.year),s.date=function(e){return(s[n.dateElementOrder]||s.mdy).call(this,e)},s.format=i.process(i.many(i.any(i.process(i.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(t){if(s[t])return s[t];throw e.Parsing.Exception(t)}),i.process(i.rtoken(/^[^dMyhHmstz]+/),function(e){return i.ignore(i.stoken(e))}))),function(e){return i.process(i.each.apply(null,e),o.finishExact)});var f={},l=function(e){return f[e]=f[e]||s.format(e)[0]};s.formats=function(e){if(e instanceof Array){var t=[];for(var n=0;n<e.length;n++)t.push(l(e[n]));return i.any.apply(null,t)}return l(e)},s._formats=s.formats(['"yyyy-MM-ddTHH:mm:ssZ"',"yyyy-MM-ddTHH:mm:ssZ","yyyy-MM-ddTHH:mm:ssz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mmZ","yyyy-MM-ddTHH:mmz","yyyy-MM-ddTHH:mm","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","MMddyyyy","ddMMyyyy","Mddyyyy","ddMyyyy","Mdyyyy","dMyyyy","yyyy","Mdyy","dMyy","d"]),s._start=i.process(i.set([s.date,s.time,s.expression],s.generalDelimiter,s.whiteSpace),o.finish),s.start=function(e){try{var t=s._formats.call({},e);if(t[1].length===0)return t}catch(n){}return s._start.call({},e)},e._parse=e.parse,e.parse=function(t){var n=null;if(!t)return null;if(t instanceof Date)return t;try{n=e.Grammar.start.call({},t.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1"))}catch(r){return null}return n[1].length===0?n[0]:null},e.getParseFunction=function(t){var n=e.Grammar.formats(t);return function(e){var t=null;try{t=n.call({},e)}catch(r){return null}return t[1].length===0?t[0]:null}},e.parseExact=function(t,n){return e.getParseFunction(n)(t)}}();var time_formats=[[60,"just now",""],[120,"one minute ago","one minute from now"],[3600,"minutes",60],[7200,"one hour ago","one hour from now"],[86400,"hours",3600],[172800,"yesterday","tomorrow"],[604800,"days",86400],[1209600,"last week","next week"],[2419200,"weeks",604800],[4838400,"last month","next month"],[29030400,"months",2419200],[58060800,"last year","next year"],[290304e4,"years",29030400],[580608e4,"last century","next century"],[580608e5,"centuries",290304e4]];(function(e,t,n){function i(e){return e}function s(e){return decodeURIComponent(e.replace(r," "))}var r=/\+/g,o=e.cookie=function(r,u,a){if(u!==n){a=e.extend({},o.defaults,a),u===null&&(a.expires=-1);if(typeof a.expires=="number"){var f=a.expires,l=a.expires=new Date;l.setDate(l.getDate()+f)}return u=o.json?JSON.stringify(u):String(u),t.cookie=[encodeURIComponent(r),"=",o.raw?u:encodeURIComponent(u),a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}var c=o.raw?i:s,h=t.cookie.split("; ");for(var p=0,d=h.length;p<d;p++){var v=h[p].split("=");if(c(v.shift())===r){var m=c(v.join("="));return o.json?JSON.parse(m):m}}return null};o.defaults={},e.removeCookie=function(t,n){return e.cookie(t)!==null?(e.cookie(t,null,n),!0):!1}})(jQuery,document);var _gaq=_gaq||[];(function(){$(function(){return $(".giveaway_container").each(function(){var e,t=this;return e=this.id.replace(/^giveaway_/,""),$(this).addClass("callout").html(""),$.ajax({url:AT.config.proxy+"/giveaways/new?giveaway_id="+e,type:"GET",data:{embedded_at_url:document.location.href},success:function(e){var n,r,i;return r=$(t).html(e).find(".giveaway-form"),$.getScript("//platform.twitter.com/widgets.js"),n=r.data("state"),n==="upcoming"?i="COME BACK SOON TO ENTER THE GIVEAWAY":n==="closed"?i="ENTRIES FOR THIS GIVEAWAY ARE CLOSED":i="ENTER THE GIVEAWAY FOR A CHANCE TO WIN!",$(t).prepend('<div class="callout-header accent-color-bg"><h1>'+i+"</h1></div>")},error:function(){var e,n;return n="HMMM, THE GIVEAWAY FORM SEEMS TO BE GIVING US THE BUSINESS",e="So sorry! Something seems to have gone wrong when loading the Giveaway form. Please try again in a few minutes.<br><br> If you continue to see this message, email the tech team at: <a href='mailto:help@apartmenttherapy.com'>help@apartmenttherapy.com</a>",$(t).html(e).prepend('<div class="callout-header accent-color-bg"><h1>'+n+"</h1></div>")}}),$("form",this).live("submit",function(e){var t,n,r;return n=$(this).serializeArray(),n.push({name:"embedded_at_url",value:document.location.href}),r=this.action.replace(/^https?:\/\/[^\/]+\//,"/"),t=$(this),$.ajax({url:AT.config.proxy+r,type:this.method,data:n,success:function(e){return $(t).html(e),$.getScript("//platform.twitter.com/widgets.js"),this.url.indexOf("alert_email_sign_up")!==-1?_gaq.push(["AllSites._trackEvent","Conversion","Email Subscribe","giveaway_alert"]):_gaq.push(["AllSites._trackEvent","Conversion","Giveaway Submission",Community.Config.page_title])},error:function(){return $(t).html("Oh no! Something went wrong.  Double check that your email is valid. If it is reload the page and try again in a few minutes.")}}),$(t).find("input:visible,:button,select").attr("disabled",!0),e.preventDefault()})})})}).call(this),function(){var e,t;window.Community?e=(t=window.Community.Config)!=null?t:{}:e={},window.Community={currentSite:function(){return window.location.host.indexOf("thekitchn")!==-1?"the_kitchn":"apartment_therapy"},Models:{},Collections:{},Routers:{},Views:{},ValidationPatterns:{bannedUrls:/^((?!.*(famalegoods.net|shoppingone.net|al.ly\/4ip|wow92.om)).*)/i},Config:_.extend({cookie_suffix:"",host:"http://"+window.location.host,proxy:"http://"+window.location.host+"/community_proxy",page_title:jQuery("title")[0].text||"N/A"},e)},$(document).ready(function(){var e;$.fn.extend({bounceOnce:function(e){return e||(e=15),$(this).animate({marginRight:e},250,"easeOutQuad").animate({marginRight:0},250,"easeInQuad")}});if(window.location.hash.substring(0,11)==="#highlight-")return e=$("#"+window.location.hash.substring(11)),e.css({position:"relative",padding:"10px",margin:"-10px"}).effect("highlight",{color:"#e9ffd9"},2500),e.append($("<span class='highlight-arrow'></span>").bounceOnce(20).bounceOnce(12).bounceOnce(6))})}.call(this),function(){var e=this;Handlebars.registerHelper("days_left",function(e){switch(e){case 0:return"Closes today!";case 1:return"One day left!";default:return""+e+" days left!"}})}.call(this),function(){var e=this;Handlebars.registerHelper("sign_in_link",function(e){return new Handlebars.SafeString("<a href='"+Community.Config.host+"/sign_in?sign_out_first=1&return_to="+encodeURIComponent(window.location.href)+"'>"+e+"</a>")}),Handlebars.registerHelper("sign_up_link",function(e){return new Handlebars.SafeString("<a href='"+Community.Config.host+"/sign_up?return_to="+encodeURIComponent(window.location.href)+"'>"+e+"</a>")}),Handlebars.registerHelper("sign_out_link",function(e){return new Handlebars.SafeString("<a href='"+Community.Config.host+"/sign_out?return_to="+encodeURIComponent(window.location.href)+"'>"+e+"</a>")}),Handlebars.registerHelper("date_format",function(e){var t;if(e&&e!=="")return t=Date.parse(e.replace(/[+-]\d\d\:\d\d/g,"")),t?t.toString("MMMM dS, yyyy")+" at "+t.toString("h:mmtt")+" EST":null}),Handlebars.registerHelper("nice_date",function(e){var t;return t=pretty_date(e),t.charAt(0).toUpperCase()+t.slice(1)}),Handlebars.registerHelper("community_url",function(e){return Community.Config.host+e}),Handlebars.registerHelper("community_proxy_url",function(e){return Community.Config.proxy+e}),Handlebars.registerHelper("community_user_url",function(e){return Community.Config.host+"/users/"+e}),Handlebars.registerHelper("comment_flagging_url",function(e,t){return Community.Config.host+"/comments/"+e+"/flagging?flag_type="+t})}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/admin/dashboard/comment_created_event"]=function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["backbone/templates/admin/dashboard/comment_created_event"]=Handlebars.template(function(e,t,n,r,i){function d(e,t){var r="",i;return r+='\n<div class="event comment clearfix ',i=n.entry_site||e.entry_site,typeof i===f?i=i.call(e,{hash:{}}):i===c&&(i=l.call(e,"entry_site",{hash:{}})),r+=h(i)+'">\n  <div class="title">\n    <a href="/users/',i=n.user_id||e.user_id,typeof i===f?i=i.call(e,{hash:{}}):i===c&&(i=l.call(e,"user_id",{hash:{}})),r+=h(i)+'">',i=n.user_display_name||e.user_display_name,typeof i===f?i=i.call(e,{hash:{}}):i===c&&(i=l.call(e,"user_display_name",{hash:{}})),r+=h(i)+'</a>\n    commented on\n    <a href="',i=n.entry_url||e.entry_url,typeof i===f?i=i.call(e,{hash:{}}):i===c&&(i=l.call(e,"entry_url",{hash:{}})),r+=h(i)+'">',i=n.entry_title_text||e.entry_title_text,typeof i===f?i=i.call(e,{hash:{}}):i===c&&(i=l.call(e,"entry_title_text",{hash:{}})),r+=h(i)+'</a>\n  </div>\n  <div class="flags">\n    <div class="delete_comment">\n      <form method="post" action="/comments/',i=n.id||e.id,typeof i===f?i=i.call(e,{hash:{}}):i===c&&(i=l.call(e,"id",{hash:{}})),r+=h(i)+'" class="button-to">\n        <div>\n          <input name="_method" type="hidden" value="delete">\n          <input  onclick="return confirm(\'Are you sure you want to delete this comment?\');" type="submit" value="Delete">\n        </div>\n      </form>\n    </div>\n    <div class="ban_user">\n      <form method="post" action="/admin/users/',i=n.user_id||e.user_id,typeof i===f?i=i.call(e,{hash:{}}):i===c&&(i=l.call(e,"user_id",{hash:{}})),r+=h(i)+'/ban" class="button-to">\n        <div>\n          <input name="_method" type="hidden" value="put">\n          <input onclick="return confirm(\'Are you sure you want to ban this user?\');" type="submit" value="Ban User">\n        </div>\n      </form>\n    </div>\n    <a class="toggle-body" href="#">Toggle Body</a>\n  </div>\n  <div class="body">\n    ',i=n.body||e.body,typeof i===f?i=i.call(e,{hash:{}}):i===c&&(i=l.call(e,"body",{hash:{}})),r+=h(i)+"\n  </div>\n<div>\n",r}n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0,h=this.escapeExpression,p=n.blockHelperMissing;o=n.comment||t.comment,u=a.program(1,d,i),u.hash={},u.fn=u,u.inverse=a.noop,typeof o===f?o=o.call(t,u):o=p.call(t,o,u);if(o||o===0)s+=o;return s+="\n",s}),HandlebarsTemplates["backbone/templates/admin/dashboard/comment_created_event"]}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/admin/dashboard/comment_flagged"]=function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["backbone/templates/admin/dashboard/comment_flagged"]=Handlebars.template(function(e,t,n,r,i){function d(e,t){var r="",i;return r+="\n    flagged ",i=n.flagging||e.flagging,i=i===null||i===undefined||i===!1?i:i.flag_type,typeof i===l?i=i.call(e,{hash:{}}):i===h&&(i=c.call(e,"flagging.flag_type",{hash:{}})),r+=p(i)+"\n    ",r}n=n||e.helpers;var s="",o,u,a,f=this,l="function",c=n.helperMissing,h=void 0,p=this.escapeExpression;s+='<div class="event">\n  <div class="title">\n    Comment by <a href="/users/',o=n.comment||t.comment,o=o===null||o===undefined||o===!1?o:o.user_id,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"comment.user_id",{hash:{}})),s+=p(o)+'">',o=n.comment||t.comment,o=o===null||o===undefined||o===!1?o:o.user_display_name,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"comment.user_display_name",{hash:{}})),s+=p(o)+'</a> on <a href="',o=n.comment||t.comment,o=o===null||o===undefined||o===!1?o:o.entry_url,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"comment.entry_url",{hash:{}})),s+=p(o)+'">',o=n.comment||t.comment,o=o===null||o===undefined||o===!1?o:o.entry_title_text,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"comment.entry_title_text",{hash:{}})),s+=p(o)+'</a>\n    <div class="body">\n      ',o=n.body||t.body,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"body",{hash:{}})),s+=p(o)+"\n    </div>\n    ",o=n.flagging||t.flagging,u=n["if"],a=f.program(1,d,i),a.hash={},a.fn=a,a.inverse=f.noop,o=u.call(t,o,a);if(o||o===0)s+=o;return s+='\n    <div class="toggle body">\n      <a href="#">Toggle Body</a>\n    </div>\n  </div>\n  <div class="buttons"></div>\n</div>\n',s}),HandlebarsTemplates["backbone/templates/admin/dashboard/comment_flagged"]}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/approval_ballots/show"]=function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["backbone/templates/approval_ballots/show"]=Handlebars.template(function(e,t,n,r,i){function d(e,t){return'\n  <div class="nominate-link">\n    Don\'t see your favorite blog here? You should <a href="#nominate" class="nominate">nominate a blog</a>!\n  </div>\n  '}function v(e,t){return'\n  <div class="empty nominate-link">\n    Nothing has been nominatated yet, you should <a href="#nominate" class="nominate">nominate a blog</a>!\n  </div>\n  '}n=n||e.helpers;var s="",o,u,a,f=this,l="function",c=n.helperMissing,h=void 0,p=this.escapeExpression;s+='<div class="approval-ballot">\n  <div class="title accent-color-bg">',o=n.name||t.name,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"name",{hash:{}})),s+=p(o)+' Nomination Ballot</div>\n  <div class="header">\n    <h2>',o=n.name||t.name,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"name",{hash:{}})),s+=p(o)+'</h2>\n    <small class="close-date">Voting ends ',o=n.closes_at||t.closes_at,u=n.date_format||t.date_format,typeof u===l?o=u.call(t,o,{hash:{}}):u===h?o=c.call(t,"date_format",o,{hash:{}}):o=u,s+=p(o)+'</small>\n    <small class="closed-message" style="display:none;">Voting has ended</small>\n  </div>\n\n  ',o=n.nominations||t.nominations,u=n["if"],a=f.program(1,d,i),a.hash={},a.fn=a,a.inverse=f.program(3,v,i),o=u.call(t,o,a);if(o||o===0)s+=o;s+='\n\n  <div class="form-response bots-only"></div>\n  <div class="nomination-form bots-only">\n    <form method="post" action="/approval_ballots/',o=n.id||t.id,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"id",{hash:{}})),s+=p(o)+'/nominate" class="nominate-blog-form">\n      <h3>Nominate a blog</h3>\n      <div class="errors bots-only"></div>\n      <div><label for="blog-name-',o=n.id||t.id,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"id",{hash:{}})),s+=p(o)+'">Name:</label><input type="text" name="name" id="blog-name-',o=n.id||t.id,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"id",{hash:{}})),s+=p(o)+'" placeholder="e.g. Apartment Therapy" /></div>\n      <div><label for="blog-url-',o=n.id||t.id,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"id",{hash:{}})),s+=p(o)+'">URL:</label><input type="text" name="url" id="blog-url-',o=n.id||t.id,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"id",{hash:{}})),s+=p(o)+'" placeholder="e.g. www.apartmenttherapy.com" /></div>\n      <input type="submit" value="Submit Nomination" />\n    </form>\n  </div>\n  <div class="login">\n    <p>To vote or nominate a blog, please ',o="sign in",u=n.sign_in_link||t.sign_in_link,typeof u===l?o=u.call(t,o,{hash:{}}):u===h?o=c.call(t,"sign_in_link",o,{hash:{}}):o=u;if(o||o===0)s+=o;s+=".</p>\n    <p>If you do not have an account, please ",o="sign up",u=n.sign_up_link||t.sign_up_link,typeof u===l?o=u.call(t,o,{hash:{}}):u===h?o=c.call(t,"sign_up_link",o,{hash:{}}):o=u;if(o||o===0)s+=o;return s+='.</p>\n  </div>\n  <table class="nominations">\n  </table>\n</div>\n',s}),HandlebarsTemplates["backbone/templates/approval_ballots/show"]}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/comments/comment"]=function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["backbone/templates/comments/comment"]=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i;return r+="\n    <div class='in-reply-to meta-item'>\n      in reply to <a href=\"#cid-",i=n.parent_id||e.parent_id,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"parent_id",{hash:{}})),r+=d(i)+'" title="Go to original comment">',i=n.parent_user||e.parent_user,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"parent_user",{hash:{}})),r+=d(i)+"</a>\n    </div>\n    ",r}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;s+='<a name="cid-',o=n.id||t.id,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"id",{hash:{}})),s+=d(o)+'"></a>\n<p class="text">',o=n.body||t.body,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"body",{hash:{}}));if(o||o===0)s+=o;s+='</p>\n<div class="footer meta">\n  <div class=\'comment-by-line\'>\n    <a href="',o=n.user_id||t.user_id,u=n.community_user_url||t.community_user_url,typeof u===c?o=u.call(t,o,{hash:{}}):u===p?o=h.call(t,"community_user_url",o,{hash:{}}):o=u,s+=d(o)+'">',o=n.user_display_name||t.user_display_name,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"user_display_name",{hash:{}})),s+=d(o)+"</a>\n  </div>\n  <div class='comment-meta'>\n    <div class='meta-item'>\n      <a href=\"#cid-",o=n.id||t.id,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"id",{hash:{}})),s+=d(o)+'" class=\'time\' title="Link to this comment">',o=n.created_at||t.created_at,u=n.nice_date||t.nice_date,typeof u===c?o=u.call(t,o,{hash:{}}):u===p?o=h.call(t,"nice_date",o,{hash:{}}):o=u,s+=d(o)+"</a>\n    </div>\n    ",o=n.parent_id||t.parent_id,u=n["if"],f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;return s+='\n  </div>\n  <div class="comment-user-actions">\n    <div class="reply-button"><a class="reply_to_comment" href="#" title="Reply to this comment" rel="nofollow">Reply</a></div>\n    <div class="flag_comment_actions">\n      <a href="#" class="show_flag_comment_actions" title="Flag this comment">Flag</a>\n      <div class="flag_comment_actions" style="display: none;">\n        <a class="flag_comment" data-flag-type=\'spam\' href="',o="spam",u=n.id||t.id,a=n.comment_flagging_url||t.comment_flagging_url,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"comment_flagging_url",u,o,{hash:{}}):o=a,s+=d(o)+'" rel="nofollow">This is spam</a><form method="post" action="',o="spam",u=n.id||t.id,a=n.comment_flagging_url||t.comment_flagging_url,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"comment_flagging_url",u,o,{hash:{}}):o=a,s+=d(o)+'" class="button-to" style="display: none; ">\n          <div>\n            <input type="submit" value="This is spam">\n          </div>\n        </form>\n      </div>\n      <div class="flag_comment_actions" style="display: none;">\n        <a class="flag_comment" data-flag-type=\'offensive\' href="',o="offensive",u=n.id||t.id,a=n.comment_flagging_url||t.comment_flagging_url,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"comment_flagging_url",u,o,{hash:{}}):o=a,s+=d(o)+'" rel="nofollow">This is offensive</a><form method="post" action="',o="offensive",u=n.id||t.id,a=n.comment_flagging_url||t.comment_flagging_url,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"comment_flagging_url",u,o,{hash:{}}):o=a,s+=d(o)+'" class="button-to" style="display: none; ">\n          <div>\n            <input type="submit" value="This is offensive">\n          </div>\n        </form>\n      </div>\n    </div>\n  </div>\n</div>\n<div class="comment-form"></div>\n',s}),HandlebarsTemplates["backbone/templates/comments/comment"]}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/comments/comment_form"]=function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["backbone/templates/comments/comment_form"]=Handlebars.template(function(e,t,n,r,i){function d(e,t){return"\n  <h3 class='form-header'>Reply to comment</h3>\n  <div class='close-reply-form'>\n    <a href=\"#\">Close</a>\n  </div>\n  "}n=n||e.helpers;var s="",o,u,a,f=this,l="function",c=n.helperMissing,h=void 0,p=this.escapeExpression;s+='<div class="comment-message"></div>\n<div class="comment-preview"> </div>\n\n<form name="commentForm" class="comment-form atco" method="post" action=""\n      data-id="',o=n.commentable_id||t.commentable_id,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"commentable_id",{hash:{}})),s+=p(o)+'"\n      data-type="',o=n.commentable_type||t.commentable_type,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"commentable_type",{hash:{}})),s+=p(o)+'"\n      data-title="',o=n.comment_object_title||t.comment_object_title,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"comment_object_title",{hash:{}})),s+=p(o)+'"\n      data-parent-id="',o=n.parent_id||t.parent_id,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"parent_id",{hash:{}})),s+=p(o)+'">\n  <a name="comment_form"></a>\n\n  <h2 class=\'form-header new-comment\'>Post a comment</h2>\n\n  ',o=n.parent_id||t.parent_id,u=n["if"],a=f.program(1,d,i),a.hash={},a.fn=a,a.inverse=f.noop,o=u.call(t,o,a);if(o||o===0)s+=o;s+='\n  <label>Comment</label>\n  <textarea name="comment[body]" class="comment-body"></textarea>\n  <div class="comment_errors"></div>\n  <div class="commenting-info new-comment">\n    <p><small>&lt;a href&gt; &lt;b&gt; &lt;i&gt; are allowed, and line breaks are automatic. Please be aware of our <a href="/commentpolicy" target="_blank">comment policy</a>. Seeing spam? <a href="http://www.formstack.com/forms/?578463-J7n6OeKtAE" target="_blank">Let us know</a>.</small></p>\n  </div>\n  <div class="comment-buttons">\n    <input value="Submit Comment" class="submit-comment" type="submit"> &nbsp;\n    <input type="button" class="preview-comment" value="Preview Comment" /> &nbsp;\n  </div>\n  <div class=\'login-info new-comment\'>\n    <br />\n    <br />\n    Logged in as ',o=n.user_display_name||t.user_display_name,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"user_display_name",{hash:{}})),s+=p(o)+"\n    &nbsp;|&nbsp;\n    ",o="Sign out",u=n.sign_out_link||t.sign_out_link,typeof u===l?o=u.call(t,o,{hash:{}}):u===h?o=c.call(t,"sign_out_link",o,{hash:{}}):o=u;if(o||o===0)s+=o;return s+="\n  </div>\n</form>\n",s}),HandlebarsTemplates["backbone/templates/comments/comment_form"]}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/comments/comments"]=function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates
["backbone/templates/comments/comments"]=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0;s+="<div class='comments-container'>\n\n</div>\n<div class='comment-form'>\n\n</div>\n<div class=\"login-message\">\n  <h3>\n    Please\n  <!--\n  # TODO: The JS that adds a \"return_to\" adds #comment_form to return URL  this breaks when the current url already has a hash\n  # (i.e. http://www.thekitchn.com/thekitchn/ingredients-vegetables/whats-the-difference-sweet-yellow-white-and-red-onions-130223#cid-1062398)\n  # Need to remove any hash before passing #comment_form hash\n  -->\n\n    ",o="Sign in",u=n.sign_in_link||t.sign_in_link,typeof u===f?o=u.call(t,o,{hash:{}}):u===c?o=l.call(t,"sign_in_link",o,{hash:{}}):o=u;if(o||o===0)s+=o;s+="\n    or\n    ",o="Sign up",u=n.sign_up_link||t.sign_up_link,typeof u===f?o=u.call(t,o,{hash:{}}):u===c?o=l.call(t,"sign_up_link",o,{hash:{}}):o=u;if(o||o===0)s+=o;return s+="\n    to comment.\n  </h3>\n</div>\n",s}),HandlebarsTemplates["backbone/templates/comments/comments"]}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/comments/preview"]=function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["backbone/templates/comments/preview"]=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u=this,a="function",f=n.helperMissing,l=void 0;s+='<div class="article comment">\n  <p class="text">',o=n.body||t.body,typeof o===a?o=o.call(t,{hash:{}}):o===l&&(o=f.call(t,"body",{hash:{}}));if(o||o===0)s+=o;return s+='</p>\n  <div class="meta">Preview</div>\n</div>\n',s}),HandlebarsTemplates["backbone/templates/comments/preview"]}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/contest_entries/favorite_button"]=function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["backbone/templates/contest_entries/favorite_button"]=Handlebars.template(function(e,t,n,r,i){function d(e,t){return"count-only"}function v(e,t){return'\n  <span class="already-favorited" style="display: none;">Favorited</span>\n  <input type="submit" class="favorite" style="display: none;" value="Favorite" />\n\n  <div class="tooltip">\n    <span class="NO_USER"><strong>You must sign in to favorite this.</strong> Click to sign in.</span>\n    <span class="UNCONFIRMED_USER"><strong>Only confirmed users can favorite this.</strong> Click to confirm your account.</span>\n    <span class="ERROR"><strong>Oops! An unexpected error occurred.</strong> Please refresh the page and try again.</span>\n  </div>\n'}n=n||e.helpers;var s="",o,u,a,f=this,l="function",c=n.helperMissing,h=void 0,p=this.escapeExpression;s+='<div class="favorite-count ',o=n.disabled||t.disabled,u=n["if"],a=f.program(1,d,i),a.hash={},a.fn=a,a.inverse=f.noop,o=u.call(t,o,a);if(o||o===0)s+=o;s+='">\n  <img src="',o="/assets/contests/heart-icon-colored.png",u=n.community_url||t.community_url,typeof u===l?o=u.call(t,o,{hash:{}}):u===h?o=c.call(t,"community_url",o,{hash:{}}):o=u,s+=p(o)+'" class="icon" />\n  <strong>',o=n.count||t.count,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"count",{hash:{}})),s+=p(o)+"</strong>\n</div>\n",o=n.disabled||t.disabled,u=n.unless,a=f.program(3,v,i),a.hash={},a.fn=a,a.inverse=f.noop,o=u.call(t,o,a);if(o||o===0)s+=o;return s+="\n",s}),HandlebarsTemplates["backbone/templates/contest_entries/favorite_button"]}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/contest_entries/show"]=function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["backbone/templates/contest_entries/show"]=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0,h=this.escapeExpression;s+='<img class="thumbnail" src="',o=n.images||t.images,o=o===null||o===undefined||o===!1?o:o[0],o=o===null||o===undefined||o===!1?o:o.small_thumbnail_url,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"images.0.small_thumbnail_url",{hash:{}})),s+=h(o)+'"/>\n<div class="favorite-button-wrapper"></div>\n\n<h3>',o=n.title||t.title,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"title",{hash:{}})),s+=h(o)+"</h3>\n<h4>",o=n.subtitle||t.subtitle,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"subtitle",{hash:{}})),s+=h(o)+'</h4>\n\n<div class="widget-notes">\n  <p class="favorite-errors" style="display: none;"></p>\n\n  <div class="user-message login-prompt" style="display: none;">\n    <p><strong>You must ',o="sign in",u=n.sign_in_link||t.sign_in_link,typeof u===f?o=u.call(t,o,{hash:{}}):u===c?o=l.call(t,"sign_in_link",o,{hash:{}}):o=u;if(o||o===0)s+=o;s+=" to add entries to your favorites.</strong></p>\n    <small>Need an account? ",o="Sign up",u=n.sign_up_link||t.sign_up_link,typeof u===f?o=u.call(t,o,{hash:{}}):u===c?o=l.call(t,"sign_up_link",o,{hash:{}}):o=u;if(o||o===0)s+=o;return s+=' for free in minutes.</small>\n  </div>\n  <div class="user-message confirm-message" style="display: none;">\n    <p><strong>Only confirmed accounts can favorite entries.</strong></p>\n    <a href="http://community.apartmenttherapy.com">Confirm your Apartment Therapy Community account now.</a>\n  </div>\n\n  <div class="before_voting-message" style="display: none;">This contest hasn&rsquo;t started yet. <a href="',o=n.contest_info||t.contest_info,o=o===null||o===undefined||o===!1?o:o.url,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"contest_info.url",{hash:{}})),s+=h(o)+'">See full contest rules &amp; dates.</a></div>\n  <small class="favorites_round-message" style="display: none;">Add entries you like to your favorites. The most favorited entries will go to the finalist round. Favoriting ends ',o=n.contest_info||t.contest_info,o=o===null||o===undefined||o===!1?o:o.favoriting_ends_at,u=n.date_format||t.date_format,typeof u===f?o=u.call(t,o,{hash:{}}):u===c?o=l.call(t,"date_format",o,{hash:{}}):o=u,s+=h(o)+', so don&rsquo;t delay!</small>\n  <div class="confirm_finalists-message" style="display: none;">Favoriting has ended and we&rsquo;re tallying up the most favorited entries!<br />Stay tuned for final voting at the <a href="',o=n.contest_info||t.contest_info,o=o===null||o===undefined||o===!1?o:o.url,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"contest_info.url",{hash:{}})),s+=h(o)+'">contest home page</a>.</div>\n  <div class="finalist_voting_round-message" style="display: none;">Favoriting has ended, but the finalists are in! Find out how to vote for your favorite at the <a href="',o=n.contest_info||t.contest_info,o=o===null||o===undefined||o===!1?o:o.url,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"contest_info.url",{hash:{}})),s+=h(o)+'">contest home page</a>.</div>\n  <div class="confirm_winner-message" style="display: none;">All voting has ended and we&rsquo;re counting up the final scores! <br />See the winner announced at the <a href="',o=n.contest_info||t.contest_info,o=o===null||o===undefined||o===!1?o:o.url,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"contest_info.url",{hash:{}})),s+=h(o)+'">contest home page</a>.</div>\n  <div class="closed-message" style="display: none;">This contest is closed. Find out who won at the <a href="',o=n.contest_info||t.contest_info,o=o===null||o===undefined||o===!1?o:o.url,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"contest_info.url",{hash:{}})),s+=h(o)+'">contest home page</a>.</div>\n\n\n\n</div>\n',s}),HandlebarsTemplates["backbone/templates/contest_entries/show"]}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/contests/_entry_list_select"]=function(){Handlebars.registerPartial("entry_list_select",Handlebars.template(function(e,t,n,r,i){function d(e,t){var r="",i,s;r+="\n    ",i=n.entries||e.entries,s=n["if"],a=f.program(2,v,t),a.hash={},a.fn=a,a.inverse=f.noop,i=s.call(e,i,a);if(i||i===0)r+=i;return r+="\n  ",r}function v(e,t){var r="",i;return r+="\n      <option>",i=n.name||e.name,typeof i===l?i=i.call(e,{hash:{}}):i===h&&(i=c.call(e,"name",{hash:{}})),r+=p(i)+"</option>\n    ",r}function m(e,t){var r="",i,s;r+="\n      ",i=n.entries||e.entries,s=n.each,a=f.programWithDepth(g,t,e),a.hash={},a.fn=a,a.inverse=f.noop,i=s.call(e,i,a);if(i||i===0)r+=i;return r+="\n    ",r}function g(e,t,r){var i="",s,o;return i+='\n        <li class="entries-widget-list-item" data-list-name="',s=n.name||r.name,typeof s===l?s=s.call(e,{hash:{}}):s===h&&(s=c.call(e,"...name",{hash:{}})),i+=p(s)+'" style="display: none;">\n          <a href="',s=n.url||e.url,typeof s===l?s=s.call(e,{hash:{}}):s===h&&(s=c.call(e,"url",{hash:{}})),i+=p(s)+'">\n            <img src="',s=n.images||e.images,s=s===null||s===undefined||s===!1?s:s[0],s=s===null||s===undefined||s===!1?s:s.mini_thumbnail_url,typeof s===l?s=s.call(e,{hash:{}}):s===h&&(s=c.call(e,"images.0.mini_thumbnail_url",{hash:{}})),i+=p(s)+'" class="thumbnail" />\n            <div>',s=n.title||e.title,typeof s===l?s=s.call(e,{hash:{}}):s===h&&(s=c.call(e,"title",{hash:{}})),i+=p(s)+'</div>\n            <strong><img src="',s="/assets/contests/heart-icon-colored-mini.png",o=n.community_url||e.community_url,typeof o===l?s=o.call(e,s,{hash:{}}):o===h?s=c.call(e,"community_url",s,{hash:{}}):s=o,i+=p(s)+'"> ',s=n.favorites_count||e.favorites_count,typeof s===l?s=s.call(e,{hash:{}}):s===h&&(s=c.call(e,"favorites_count",{hash:{}})),i+=p(s)+"</strong>\n          </a>\n        </li>\n      ",i}n=n||e.helpers;var s="",o,u,a,f=this,l="function",c=n.helperMissing,h=void 0,p=this.escapeExpression;s+="<select>\n  ",o=n.entry_lists||t.entry_lists,u=n.each,a=f.program(1,d,i),a.hash={},a.fn=a,a.inverse=f.noop,o=u.call(t,o,a);if(o||o===0)s+=o;s+='\n</select>\n\n<div class="entries-widget-list">\n  <ol class="unstyled">\n    ',o=n.entry_lists||t.entry_lists,u=n.each,a=f.program(4,m,i),a.hash={},a.fn=a,a.inverse=f.noop,o=u.call(t,o,a);if(o||o===0)s+=o;return s+='\n  </ol>\n  <div class="more">\n    <strong>\n      <a href="',o="/contests/",u=n.community_url||t.community_url,typeof u===l?o=u.call(t,o,{hash:{}}):u===h?o=c.call(t,"community_url",o,{hash:{}}):o=u,s+=p(o),o=n.human_id||t.human_id,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"human_id",{hash:{}})),s+=p(o)+'/entries">See more contest entries</a>\n    </strong>\n  </div>\n</div>\n',s}))}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/contests/entry_list_select"]=function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["backbone/templates/contests/entry_list_select"]=Handlebars.template(function(e,t,n,r,i){function d(e,t){var r="",i;return r+="\n    <option value=",i=n.division_id||e.division_id,typeof i===l?i=i.call(e,{hash:{}}):i===h&&(i=c.call(e,"division_id",{hash:{}})),r+=p(i)+">",i=n.name||e.name,typeof i===l?i=i.call(e,{hash:{}}):i===h&&(i=c.call(e,"name",{hash:{}})),r+=p(i)+"</option>\n  ",r}n=n||e.helpers;var s="",o,u,a,f=this,l="function",c=n.helperMissing,h=void 0,p=this.escapeExpression;s+="<select>\n  ",o=n.entry_lists||t.entry_lists,u=n.each,a=f.program(1,d,i),a.hash={},a.fn=a,a.inverse=f.noop,o=u.call(t,o,a);if(o||o===0)s+=o;return s+='\n</select>\n\n<div class="entries-widget-list-wrapper">\n  <img class="spinner" src="',o="/assets/",u=n.community_url||t.community_url,typeof u===l?o=u.call(t,o,{hash:{}}):u===h?o=c.call(t,"community_url",o,{hash:{}}):o=u,s+=p(o)+'spinner.gif" />\n  <ol class="unstyled entries-widget-list"></ol>\n  <a class="widget-more-link" href="',o="/contests/",u=n.community_url||t.community_url,typeof u===l?o=u.call(t,o,{hash:{}}):u===h?o=c.call(t,"community_url",o,{hash:{}}):o=u,s+=p(o),o=n.human_id||t.human_id,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"human_id",{hash:{}})),s+=p(o)+'/entries">See more contest entries</a>\n</div>\n',s}),HandlebarsTemplates["backbone/templates/contests/entry_list_select"]}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/contests/finalists"]=function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["backbone/templates/contests/finalists"]=Handlebars.template(function(e,t,n,r,i){function d(e,t,r){var i="",s,o;return i+='\n      <li class="entries-widget-list-item">\n        <a class="media-box" href="',s="/contests/",o=n.community_url||r.community_url,typeof o===l?s=o.call(e,s,{hash:{}}):o===h?s=c.call(e,"...community_url",s,{hash:{}}):s=o,i+=p(s),s=n.human_id||r.human_id,typeof s===l?s=s.call(e,{hash:{}}):s===h&&(s=c.call(e,"...human_id",{hash:{}})),i+=p(s)+'">\n          <img src="',s=n.images||e.images,s=s===null||s===undefined||s===!1?s:s[0],s=s===null||s===undefined||s===!1?s:s.mini_thumbnail_url,typeof s===l?s=s.call(e,{hash:{}}):s===h&&(s=c.call(e,"images.0.mini_thumbnail_url",{hash:{}})),i+=p(s)+'" class="media" />\n          <div class="media-body">\n            ',s=n.title||e.title,typeof s===l?s=s.call(e,{hash:{}}):s===h&&(s=c.call(e,"title",{hash:{}})),i+=p(s)+'\n            <div class="contest-color">',s=n.subtitle||e.subtitle,typeof s===l?s=s.call(e,{hash:{}}):s===h&&(s=c.call(e,"subtitle",{hash:{}})),i+=p(s)+"</div>\n          </div>\n        </a>\n      </li>\n    ",i}n=n||e.helpers;var s="",o,u,a,f=this,l="function",c=n.helperMissing,h=void 0,p=this.escapeExpression;s+='<h3 class="widget-heading contest-color">Contest Finalists</h3>\n<div class="entries-widget-list-wrapper">\n  <ol class="unstyled entries-widget-list">\n    ',o=n.finalists||t.finalists,u=n.each,a=f.programWithDepth(d,i,t),a.hash={},a.fn=a,a.inverse=f.noop,o=u.call(t,o,a);if(o||o===0)s+=o;return s+='\n  </ol>\n  <a class="widget-more-link" href="',o="/contests/",u=n.community_url||t.community_url,typeof u===l?o=u.call(t,o,{hash:{}}):u===h?o=c.call(t,"community_url",o,{hash:{}}):o=u,s+=p(o),o=n.human_id||t.human_id,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"human_id",{hash:{}})),s+=p(o)+'">Vote for the winner!</a>\n</div>\n',s}),HandlebarsTemplates["backbone/templates/contests/finalists"]}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/contests/top_entries_widget"]=function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["backbone/templates/contests/top_entries_widget"]=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0,h=this.escapeExpression;return s+='<a href="',o="/contests/",u=n.community_url||t.community_url,typeof u===f?o=u.call(t,o,{hash:{}}):u===c?o=l.call(t,"community_url",o,{hash:{}}):o=u,s+=h(o),o=n.human_id||t.human_id,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"human_id",{hash:{}})),s+=h(o)+'">\n  <img src="',o="/assets/contests/",u=n.community_url||t.community_url,typeof u===f?o=u.call(t,o,{hash:{}}):u===c?o=l.call(t,"community_url",o,{hash:{}}):o=u,s+=h(o),o=n.human_id||t.human_id,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"human_id",{hash:{}})),s+=h(o)+'/mini-banner.png" />\n</a>\n<div class="widget-content">\n</div>\n\n<!-- <img class="contest-widget-sponsor-banner" src="',o="/assets/contests/",u=n.community_url||t.community_url,typeof u===f?o=u.call(t,o,{hash:{}}):u===c?o=l.call(t,"community_url",o,{hash:{}}):o=u,s+=h(o),o=n.human_id||t.human_id,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"human_id",{hash:{}})),s+=h(o)+'/mini-sponsor-horz.png"}}" /> -->\n',s}),HandlebarsTemplates["backbone/templates/contests/top_entries_widget"]}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/contests/widget_entry"]=function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["backbone/templates/contests/widget_entry"]=Handlebars.template(function(e,t,n,r,i){function d(e,t,r){var i="",s,o;return i+='\n  <li class="entries-widget-list-item" data-list-name="division-',s=n.division_id||r.division_id,typeof s===l?s=s.call(e,{hash:{}}):s===h&&(s=c.call(e,"...division_id",{hash:{}})),i+=p(s)+'" style="display: none;">\n    <a class="media-box" href="',s=n.url||e.url,typeof s===l?s=s.call(e,{hash:{}}):s===h&&(s=c.call(e,"url",{hash:{}})),i+=p(s)+'">\n      <img src="',s=n.images||e.images,s=s===null||s===undefined||s===!1?s:s[0],s=s===null||s===undefined||s===!1?s:s.mini_thumbnail_url,typeof s===l?s=s.call(e,{hash:{}}):s===h&&(s=c.call(e,"images.0.mini_thumbnail_url",{hash:{}})),i+=p(s)+'" class="media" />\n      <div class="media-body">\n        ',s=n.title||e.title,typeof s===l?s=s.call(e,{hash:{}}):s===h&&(s=c.call(e,"title",{hash:{}})),i+=p(s)+'\n        <div class="contest-color entries-widget-favorite-count"><img src="',s="/assets/contests/heart-icon-colored-mini.png",o=n.community_url||e.community_url,typeof o===l?s=o.call(e,s,{hash:{}}):o===h?s=c.call(e,"community_url",s,{hash:{}}):s=o,i+=p(s)+'"> ',s=n.favorites_count||e.favorites_count,typeof s===l?s=s.call(e,{hash:{}}):s===h&&(s=c.call(e,"favorites_count",{hash:{}})),i+=p(s)+"</div>\n      </div>\n    </a>\n  </li>\n",i}n=n||e.helpers;var s="",o,u,a,f=this,l="function",c=n.helperMissing,h=void 0,p=this.escapeExpression;o=n.entries||t.entries,u=n.each,a=f.programWithDepth(d,i,t),a.hash={},a.fn=a,a.inverse=f.noop,o=u.call(t,o,a);if(o||o===0)s+=o;return s+="\n",s}),HandlebarsTemplates["backbone/templates/contests/widget_entry"]}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/contests/winners"]=function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["backbone/templates/contests/winners"]=Handlebars.template(function(e,t,n,r,i){function d(e,t){var r="",i;return r+='\n      <li class="entries-widget-list-item">\n        <a class="media-box" href="',i=n.url||e.url,typeof i===l?i=i.call(e,{hash:{}}):i===h&&(i=c.call(e,"url",{hash:{}})),r+=p(i)+'">\n          <img class="media" src="',i=n.images||e.images,i=i===null||i===undefined||i===!1?i:i[0],i=i===null||i===undefined||i===!1?i:i.mini_thumbnail_url,typeof i===l?i=i.call(e,{hash:{}}):i===h&&(i=c.call(e,"images.0.mini_thumbnail_url",{hash:{}})),r+=p(i)+'" />\n          <div class="media-body">\n            ',i=n.title||e.title,typeof i===l?i=i.call(e,{hash:{}}):i===h&&(i=c.call(e,"title",{hash:{}})),r+=p(i)+'\n            <div class="contest-color">',i=n.subtitle||e.subtitle,typeof i===l?i=i.call(e,{hash:{}}):i===h&&(i=c.call(e,"subtitle",{hash:{}})),r+=p(i)+"</div>\n          </div>\n        </a>\n      </li>\n    ",r}n=n||e.helpers;var s="",o,u,a,f=this,l="function",c=n.helperMissing,h=void 0,p=this.escapeExpression;s+='<h3 class="widget-heading contest-color">Contest Winners!</h3>\n<div class="entries-widget-list-wrapper">\n  <ol class="unstyled entries-widget-list">\n    ',o=n.winning_entries||t.winning_entries,u=n.each,a=f.program(1,d,i),a.hash={},a.fn=a,a.inverse=f.noop,o=u.call(t,o,a);if(o||o===0)s+=o;return s+='\n  </ol>\n  <a class="widget-more-link" href="',o="/contests/",u=n.community_url||t.community_url,typeof u===l?o=u.call(t,o,{hash:{}}):u===h?o=c.call(t,"community_url",o,{hash:{}}):o=u,s+=p(o),o=n.human_id||t.human_id,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"human_id",{hash:{}})),s+=p(o)+'/entries">See all contest entries</a>\n</div>\n',s}),HandlebarsTemplates["backbone/templates/contests/winners"]}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/giveaway_collections/giveaway_collections_widget"]=function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["backbone/templates/giveaway_collections/giveaway_collections_widget"]=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i,s;r+="\n    ",i=n.upcoming_giveaways||e.upcoming_giveaways,s=n["if"],a=f.program(2,m,t),a.hash={},a.fn=a,a.inverse=f.program(4,g,t),i=s.call(e,i,a);if(i||i===0)r+=i;return r+="\n  ",r}function m(e,t){return"\n      <p>There are no active giveaways. Click more to see when the next one is!</p>\n    "}function g(e,t){return"\n      <p>All giveaways have ended.</p>\n    "}function y(e,t){var r="",i;return r+='\n       <li class="entries-widget-list-item giveaway-',i=n.vertical||e.vertical,typeof i===l?i=i.call(e,{hash:{}}):i===h&&(i=c.call(e,"vertical",{hash:{}})),r+=p(i)+'" style="display:none;" >\n          <a class="media-box" href="',i=n.blog_post_url||e.blog_post_url,typeof i===l?i=i.call(e,{hash:{}}):i===h&&(i=c.call(e,"blog_post_url",{hash:{}})),r+=p(i)+'">\n            <img src="',i=n.image||e.image,i=i===null||i===undefined||i===!1?i:i.mini_thumbnail_url,typeof i===l?i=i.call(e,{hash:{}}):i===h&&(i=c.call(e,"image.mini_thumbnail_url",{hash:{}})),r+=p(i)+'" class="media" />\n            <div class="media-body">\n              ',i=n.name||e.name,typeof i===l?i=i.call(e,{hash:{}}):i===h&&(i=c.call(e,"name",{hash:{}})),r+=p(i)+'\n              <div class="giveaway2012-color"><strong>',i=n.price||e.price,typeof i===l?i=i.call(e,{hash:{}}):i===h&&(i=c.call(e,"price",{hash:{}})),r+=p(i)+" value</strong></div>\n            </div>\n          </a>\n        </li>\n      ",r}function b(e,t){return"\n      See the winners\n    "}function w(e,t){return"\n      See more giveaways\n    "}n=n||e.helpers;var s="",o,u,a,f=this,l="function",c=n.helperMissing,h=void 0,p=this.escapeExpression,d=n.blockHelperMissing;s+='<a href="',o="/giveaways/",u=n.community_url||t.community_url,typeof u===l?o=u.call(t,o,{hash:{}}):u===h?o=c.call(t,"community_url",o,{hash:{}}):o=u,s+=p(o),o=n.human_id||t.human_id,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"human_id",{hash:{}})),s+=p(o)+'">\n  <img src="',o="/assets/giveaways/",u=n.community_url||t.community_url,typeof u===l?o=u.call(t,o,{hash:{}}):u===h?o=c.call(t,"community_url",o,{hash:{}}):o=u,s+=p(o),o=n.human_id||t.human_id,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"human_id",{hash:{}})),s+=p(o)+'/mini-banner.png"}}" />\n</a>\n\n<div class="widget-content">\n  ',o=n.active_giveaways||t.active_giveaways,u=n.unless,a=f.program(1,v,i),a.hash={},a.fn=a,a.inverse=f.noop,o=u.call(t,o,a);if(o||o===0)s+=o;s+='\n  <div class="entries-widget-list-wrapper">\n    <ol class="unstyled entries-widget-list">\n     ',o=n.active_giveaways||t.active_giveaways,a=f.program(6,y,i),a.hash={},a.fn=a,a.inverse=f.noop,typeof o===l?o=o.call(t,a):o=d.call(t,o,a);if(o||o===0)s+=o;s+='\n    </ol>\n\n  <a class="widget-more-link" href="',o="/giveaways/",u=n.community_url||t.community_url,typeof u===l?o=u.call(t,o,{hash:{}}):u===h?o=c.call(t,"community_url",o,{hash:{}}):o=u,s+=p(o),o=n.human_id||t.human_id,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"human_id",{hash:{}})),s+=p(o)+'">\n    ',o=n.upcoming_giveaways||t.upcoming_giveaways,u=n.unless,a=f.program(8,b,i),a.hash={},a.fn=a,a.inverse=f.program(10,w,i),o=u.call(t,o,a);if(o||o===0)s+=o;return s+="\n  </a>\n</div>\n\n",s}),HandlebarsTemplates["backbone/templates/giveaway_collections/giveaway_collections_widget"]}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/nominations/nomination"]=function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["backbone/templates/nominations/nomination"]=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u=this,a="function",f=n.helperMissing,l=void 0,c=this.escapeExpression;return s+='<td>\n  <form method="post" action="/nominations/',o=n.id||t.id,typeof o===a?o=o.call(t,{hash:{}}):o===l&&(o=f.call(t,"id",{hash:{}})),s+=c(o)+'/vote">\n    <span class="favorited">&#10003; Voted</span>\n    <input type="submit" class="vote" id="vote-',o=n.id||t.id,typeof o===a?o=o.call(t,{hash:{}}):o===l&&(o=f.call(t,"id",{hash:{}})),s+=c(o)+'" value="Vote" />\n    <a href="',o=n.url||t.url,typeof o===a?o=o.call(t,{hash:{}}):o===l&&(o=f.call(t,"url",{hash:{}})),s+=c(o)+'" class="nomination-name" target="_blank">\n      ',o=n.name||t.name,typeof o===a?o=o.call(t,{hash:{}}):o===l&&(o=f.call(t,"name",{hash:{}})),s+=c(o)+" <small>",o=n.url||t.url,typeof o===a?o=o.call(t,{hash:{}}):o===l&&(o=f.call(t,"url",{hash:{}})),s+=c(o)+'</small>\n    </a>\n    <div class="nomination-errors bots-only"></div>\n  </form>\n</td>\n<td class="vote-count"><strong>',o=n.favorites_count||t.favorites_count,typeof o===a?o=o.call(t,{hash:{}}):o===l&&(o=f.call(t,"favorites_count",{hash:{}})),s+=c(o)+"</strong> <small>votes</small></td>\n",s}),HandlebarsTemplates["backbone/templates/nominations/nomination"]}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/surveys/survey_form"]=function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["backbone/templates/surveys/survey_form"]=Handlebars.template(function(e,t,n,r,i){function d(e,t){var r="",i;r+="\n        <li class='radio'>\n          <label for='survey_position",i=n.position||e.position,typeof i===f?i=i.call(e,{hash:{}}):i===c&&(i=l.call(e,"position",{hash:{}})),r+=h(i)+"'>\n            <input type='radio' id='survey_position",i=n.position||e.position,typeof i===f?i=i.call(e,{hash:{}}):i===c&&(i=l.call(e,"position",{hash:{}})),r+=h(i)+"' name='position' value='",i=n.position||e.position,typeof i===f?i=i.call(e,{hash:{}}):i===c&&(i=l.call(e,"position",{hash:{}})),r+=h(i)+"'>\n            ",i=n.answer||e.answer,typeof i===f?i=i.call(e,{hash:{}}):i===c&&(i=l.call(e,"answer",{hash:{}}));if(i||i===0)r+=i;return r+="\n          </label>\n        </li>\n      ",r}n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0,h=this.escapeExpression,p=n.blockHelperMissing;s+="<div class='title accent-color-bg'>Take the survey!</div>\n<div class='header accent'><h3>",o=n.question||t.question,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"question",{hash:{}}));if(o||o===0)s+=o;s+="</h3></div>\n<div class='survey_form'>\n  <form method='POST' action=''>\n    <ol class='unstyled'>\n      ",o=n.choices||t.choices,u=a.program(1,d,i),u.hash={},u.fn=u,u.inverse=a.noop,typeof o===f?o=o.call(t,u):o=p.call(t,o,u);if(o||o===0)s+=o;return s+="\n    </ol>\n    <input type='submit' value='Vote'>\n    <a href='#' class='show-results secondary'>Show the results</a>\n  </form>\n</div>\n",s}),HandlebarsTemplates["backbone/templates/surveys/survey_form"]}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/surveys/survey_login_message"]=function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["backbone/templates/surveys/survey_login_message"]=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0;s+="<p>\n  To take the survey ",o="sign in",u=n.sign_in_link||t.sign_in_link,typeof u===f?o=u.call(t,o,{hash:{}}):u===c?o=l.call(t,"sign_in_link",o,{hash:{}}):o=u;if(o||o===0)s+=o;s+=".\n  If you do not have an account ",o="register",u=n.sign_up_link||t.sign_up_link,typeof u===f?o=u.call(t,o,{hash:{}}):u===c?o=l.call(t,"sign_up_link",o,{hash:{}}):o=u;if(o||o===0)s+=o;return s+=".\n</p>\n",s}),HandlebarsTemplates["backbone/templates/surveys/survey_login_message"]}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/surveys/survey_results"]=function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["backbone/templates/surveys/survey_results"]=Handlebars.template(function(e,t,n,r,i){function d(e,t){var r="",i;r+="\n      <tr>\n        <td class='response'>",i=n.answer||e.answer,typeof i===f?i=i.call(e,{hash:{}}):i===c&&(i=l.call(e,"answer",{hash:{}}));if(i||i===0)r+=i;return r+='</td>\n        <td>\n          <div class="bar">\n            <div class="bar-votes accent-color-bg" style="width: ',i=n.percentage||e.percentage,typeof i===f?i=i.call(e,{hash:{}}):i===c&&(i=l.call(e,"percentage",{hash:{}})),r+=h(i)+"%;\"></div>\n          </div>\n        </td>\n        <td class='vote-count'><strong>",i=n.votes||e.votes,typeof i===f?i=i.call(e,{hash:{}}):i===c&&(i=l.call(e,"votes",{hash:{}})),r+=h(i)+"</strong> <small>votes</small></td>\n      </tr>\n    ",r}n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0,h=this.escapeExpression,p=n.blockHelperMissing;s+="<div class='survey_results'>\n  <table>\n    ",o=n.choices||t.choices,u=a.program(1,d,i),u.hash={},u.fn=u,u.inverse=a.noop,typeof o===f?o=o.call(t,u):o=p.call(t,o,u);if(o||o===0)s+=o;return s+="\n  </table>\n</div>\n",s}),HandlebarsTemplates["backbone/templates/surveys/survey_results"]}.call(this)}.call(this),function(){var e,t,n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};Community.Models||(Community.Models={}),Community.Models.ApprovalBallot=function(t){function n(){return e=n.__super__.constructor.apply(this,arguments),e}return r(n,t),n.prototype.paramRoot="approval_ballot",n.prototype.defaults={name:null,starts:null,ends:null},n.prototype.relations=[{type:Backbone.HasMany,key:"nominations",relatedModel:"Community.Models.Nomination",collectionType:"Community.Collections.NominationsCollection"}],n.prototype.url=function(e){var t;return e==null&&(e=null),t=Community.Config.proxy+"/approval_ballots",this.isNew()?t:e?t+"/"+this.id+e+".json":t+"/"+this.id+".json"},n.prototype.nominate=function(e){return e==null&&(e={}),$.ajax({type:"POST",url:this.url("/nominate"),data:{name:e.name,url:e.url},success:e.success,error:e.error,statusCode:e.statusCode})},n.prototype.vote=function(e,t){return t==null&&(t={}),this.get("nominations").get(e).vote(t)},n}(Backbone.RelationalModel),Community.Collections.ApprovalBallotsCollection=function(e){function n(){return t=n.__super__.constructor.apply(this,arguments),t}return r(n,e),n.prototype.model=Community.Models.ApprovalBallot,n.prototype.url=Community.Config.proxy+"/approval_ballots",n}(Backbone.Collection)}.call(this),function(){var e,t,n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};Community.Models||(Community.Models={}),Community.Models.Comment=function(t){function n(){return e=n.__super__.constructor.apply(this,arguments),e}return r(n,t),n.prototype.urlRoot=function(){return Community.Config.proxy+"/comments"},n.prototype.validate=function(e){var t;return t=[],e.body||t.push({attribute:"body",message:"Comment cannot be empty."}),e.body.length>2||t.push({attribute:"body",message:"Comment must contain at least two characters."}),this.hasBannedUrls(e.body)||t.push({attribute:"body",message:"Comment cannot contain banned URLs."}),t.length>0?t:!1},n.prototype.hasBannedUrls=function(e){return e.match(Community.ValidationPatterns.bannedUrls)},n.prototype.parentId=function(){var e,t;return e=(t=this.get("ancestry"))!=null?t.split("/"):void 0,e?e[e.length-1]:null},n.prototype.ancestors=function(){var e,t;return e=(t=this.get("ancestry"))!=null?t.split("/"):void 0},n.prototype.parentUser=function(){var e,t;e=this.parentId();if(e!=null&&this.collection!=null)return(t=this.collection.get(this.parentId()))!=null?t.get("user_display_name"):void 0},n.prototype.isStaff=function(){return _.include(Community.Config.author_community_user_ids,parseInt(this.get("user_id")))},n.prototype.flag=function(e,t,n){return t||(t=function(){}),n||(n=function(){}),$.ajax({url:Community.Config.proxy+"/comments/"+this.get("id")+"/flagging?flag_type="+e,dataType:"json",cache:!1,type:"POST",success:t,error:n})},n.prototype.preview=function(e){var t=this;return e==null&&(e={}),$.ajax({url:Community.Config.proxy+"/comments/preview.json",dataType:"json",cache:!1,type:"GET",data:{comment:{body:this.get("body"),commentable_id:this.get("commentable_id"),commentable_title:this.get("commentable_title"),commentable_type:this.get("commentable_type")}},success:function(n){return t.set("body",n.body),e.success(n)},error:e.error})},n.prototype.toJSON=function(){var e;return e=this.constructor.__super__.toJSON.apply(this,arguments),e.comment=_.clone(this.attributes),e.parent_id||(e.parent_id=this.parentId()),e.parent_user||(e.parent_user=this.parentUser()),e},n}(Backbone.Model),Community.Collections.Comments=function(e){function n(){return t=n.__super__.constructor.apply(this,arguments),t}return r(n,e),n.prototype.model=Community.Models.Comment,n.prototype.url=function(){return Community.Config.proxy+"/comments"},n.prototype.fetchCommentableComments=function(e,t,n){return n==null&&(n={}),this.fetch(_({url:Community.Config.proxy+"/commentable/"+t+"/"+e+"/comments"}).extend(n))},n}(Backbone.Collection)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this
.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Community.Models||(Community.Models={}),Community.Models.Contest=function(t){function r(){return e=r.__super__.constructor.apply(this,arguments),e}return n(r,t),r.prototype.idAttribute="human_id",r.prototype.fetchDivisionLeaders=function(e,t){return $.get(this.url("division_leaders/"+e),{},t)},r.prototype.url=function(e){var t;return e==null&&(e=null),t=Community.Config.proxy+"/contests/"+this.id,this.isNew()?t:e?t+"/"+e+".json":t+".json"},r}(Backbone.Model)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Community.Models||(Community.Models={}),Community.Models.ContestEntry=function(t){function r(){return e=r.__super__.constructor.apply(this,arguments),e}return n(r,t),r.prototype.url=function(e){var t;return e==null&&(e=null),t=Community.Config.proxy+"/contests/"+this.get("contestHumanId")+"/entries",this.isNew()?t:e?t+"/"+this.id+e+".json":t+"/"+this.id+".json"},r.prototype.isVotingRound=function(){return this.get("contest_info").state==="favorites_round"},r.prototype.favorite=function(e){return e==null&&(e={}),$.ajax({type:"POST",url:this.url("/favorites"),success:e.success,error:e.error,statusCode:e.statusCode})},r}(Backbone.Model)}.call(this),function(){var e,t,n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};Community.Models||(Community.Models={}),Community.Models.Favorite=function(t){function n(){return e=n.__super__.constructor.apply(this,arguments),e}return r(n,t),n.prototype.paramRoot="favorite",n.prototype.url=function(){var e;return e=Community.Config.proxy+"/favorites",this.isNew()?e:e+"/"+this.id},n}(Backbone.RelationalModel),Community.Collections.FavoritesCollection=function(e){function n(){return t=n.__super__.constructor.apply(this,arguments),t}return r(n,e),n.prototype.model=Community.Models.Favorite,n.prototype.url=Community.Config.proxy+"/favorites",n}(Backbone.Collection)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Community.Models||(Community.Models={}),Community.Models.GiveawayCollection=function(t){function r(){return e=r.__super__.constructor.apply(this,arguments),e}return n(r,t),r.prototype.idAttribute="human_id",r.prototype.url=function(e){var t;return e==null&&(e=null),t=Community.Config.proxy+"/giveaways/"+this.id,this.isNew()?t:e?t+"/"+e+".json":t+".json"},r}(Backbone.Model)}.call(this),function(){var e,t,n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};Community.Models||(Community.Models={}),Community.Models.Nomination=function(t){function n(){return e=n.__super__.constructor.apply(this,arguments),e}return r(n,t),n.prototype.paramRoot="nomination",n.prototype.defaults={name:null,url:null,aliases:{},user_id:null},n.prototype.url=function(e){var t;return t=Community.Config.proxy+"/nominations",this.isNew()?t:e?t+"/"+this.id+e+".json":t+"/"+this.id+".json"},n.prototype.vote=function(e){return e==null&&(e={}),$.ajax({type:"POST",url:this.url("/vote"),success:e.success,error:e.error,statusCode:e.statusCode})},n}(Backbone.RelationalModel),Community.Collections.NominationsCollection=function(e){function n(){return t=n.__super__.constructor.apply(this,arguments),t}return r(n,e),n.prototype.model=Community.Models.Nomination,n.prototype.url=Community.Config.proxy+"/nominations",n}(Backbone.Collection)}.call(this),function(){var e,t,n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};Community.Models||(Community.Models={}),Community.Models.Survey=function(t){function n(){return e=n.__super__.constructor.apply(this,arguments),e}return r(n,t),n.prototype.urlRoot=function(){return Community.Config.proxy+"/surveys"},n.prototype.vote=function(e,t){return $.ajax({url:Community.Config.proxy+"/surveys/"+this.get("id")+"/vote.json",dataType:"json",type:"POST",data:{position:e},success:t.success,error:t.error})},n.prototype.state=function(){return this.options&&this.options.state&&_.isString(this.options.state)?this.options.state:this.get("closed")?"closed":this.get("user_logged_in")?this.get("user_voted")?"voted":"not_voted":"not_logged_in"},n}(Backbone.Model),Community.Collections.Surveys=function(e){function n(){return t=n.__super__.constructor.apply(this,arguments),t}return r(n,e),n.prototype.model=Community.Models.Survey,n.prototype.url=function(){return Community.Config.proxy+"/surveys"},n}(Backbone.Collection)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Community.Models||(Community.Models={}),Community.Models.User=function(t){function r(){return e=r.__super__.constructor.apply(this,arguments),e}return n(r,t),r.prototype.paramRoot="user",r.prototype.relations=[{type:Backbone.HasMany,key:"favorites",relatedModel:"Community.Models.Favorite",collectionType:"Community.Collections.FavoritesCollection"}],r.prototype.url=function(){var e;return e=Community.Config.proxy+"/users",this.isNew()?e:e+"/"+this.id+".json"},r.prototype.editUrl=function(){return Community.Config.host+"/users/"+this.id+"-"+"/edit"},r.clearStaleSessionCookies=function(){var e;return e=Community.Config.cookie_suffix||"",$.removeCookie("user_display_name"+e),$.removeCookie("user_friendly_id"+e),$.removeCookie("remember_token"+e)},r.current=function(){var e,t,n;return this._current===void 0&&(e=Community.Config.cookie_suffix||"",t=$.cookie("user_display_name"+e,void 0,{unescapeSpaces:!0}),n=$.cookie("user_friendly_id"+e,void 0,{unescapeSpaces:!0}),t&&n?this._current=new this({display_name:t,id:n}):this._current=null),this._current},r.loggedIn=function(){return!!this.current()},r.active_fetures={truncate_long_comments:!0},r.users_with_feature_map={},r.feature_is_active=function(e){var t,n;return this.active_features[e]?!0:(t=Community.Models.User.current(),n=this.users_with_feature_map,t&&n?_(n).include(t.get("display_name").toLowerCase()):!1)},r}(Backbone.RelationalModel)}.call(this),function(){var e,t,n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};(e=Community.Views).ApprovalBallots||(e.ApprovalBallots={}),Community.Views.ApprovalBallots.ApprovalBallotView=function(e){function n(){return t=n.__super__.constructor.apply(this,arguments),t}return r(n,e),n.prototype.template=JST["backbone/templates/approval_ballots/show"],n.prototype.events={"click .nominate":"showNominationForm","submit .nomination-form form":"nominate"},n.prototype.initialize=function(){return this.model=new Community.Models.ApprovalBallot({id:this.getApprovalBallotId()})},n.prototype.getApprovalBallotId=function(e){return e==null&&(e=this.el),$(e).attr("id").substr(16)},n.prototype.showLoginForm=function(){return this.$(".login").show()},n.prototype.hideLoginForm=function(){return this.$(".login").hide()},n.prototype.hideNominationLink=function(){return this.$(".nominate-link").hide()},n.prototype.showNominationLink=function(){return this.$(".nominate-link").show()},n.prototype.showNominationForm=function(){return this.$(".nominate-link").hide(),this.$(".nomination-form").show()},n.prototype.hideNominationForm=function(){return this.$(".nominate-link").show(),this.$(".nomination-form").hide()},n.prototype.showClosedMessage=function(){return this.$(".close-date").hide(),this.$(".closed-message").show()},n.prototype.nominate=function(e){var t,n,r,i,s=this;return e.preventDefault(),_gaq.push(["AllSites._trackEvent","Reader Action","Homies Vote",this.model.get("name")]),this.$(e.target).attr("disabled",!0),r=this.$("#blog-name-"+this.model.id).val(),i=this.$("#blog-url-"+this.model.id).val(),i.length>0&&r.length>0?this.model.nominate({url:i,name:r,success:function(){return s.$(".form-response").html("<div class='nominate-link'>Thanks for your submission! We will review and post it soon. <br />Feel free to <a href='#nominate' class='nominate'>submit another blog</a>!</div>"),s.$(".form-response").show(),s.$(".nomination-form input[type=text]").val(""),s.$(".nomination-form").hide(),s.$(".errors").hide()},error:function(e){var t,n;return n=_.flatten(_.values($.parseJSON(e.responseText).errors)),t=n.join("<br/>"),s.$(".errors").show().html(t).effect("highlight",{},3e3)}}):(n=[],i.length<1&&n.push("You must have a URL for your nomination."),r.length<1&&n.push("You must have a name for your nomination."),t=n.join("<br/>"),this.$(".errors").show().html(t).effect("highlight",{},3e3))},n.prototype.renderWithUser=function(e){var t=this;return this.model.fetch({success:function(n,r){return $(t.el).html(t.template(n.toJSON())),e&&!n.attributes["closed?"]?t.hideLoginForm():n.attributes["closed?"]?(t.hideLoginForm(),t.hideNominationLink(),t.showClosedMessage()):(t.showLoginForm(),t.hideNominationLink()),t._nominationCollectionView=new Community.Views.Nominations.NominationCollectionView({collection:t.model.get("nominations"),el:t.$(".nominations"),user:e,approvalBallot:t.model}),t._nominationCollectionView.render()}})},n.prototype.render=function(){var e,t=this;return $(this.el).addClass("embedded-form-widget"),e=Community.Models.User.current(),e?e.fetch({success:function(){return t.renderWithUser(e)}}):this.renderWithUser(e),this},n}(Backbone.View)}.call(this),function(){var e,t,n=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty,i=function(e,t){function i(){this.constructor=e}for(var n in t)r.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};(e=Community.Views).Comments||(e.Comments={}),Community.Views.Comments.CommentFormView=function(e){function r(){return this.showPreviewSuccess=n(this.showPreviewSuccess,this),t=r.__super__.constructor.apply(this,arguments),t}return i(r,e),r.prototype.template=JST["backbone/templates/comments/comment_form"],r.prototype.previewTemplate=JST["backbone/templates/comments/preview"],r.prototype.initialize=function(){return this.reset()},r.prototype.reset=function(){return this.$el.find(".comment-body").val(null),this.model=new Community.Models.Comment({commentable_id:this.options.commentable_id,commentable_title:this.options.commentable_title,commentable_type:this.options.commentable_type,commentable_url:this.options.commentable_url,user_display_name:Community.Models.User.current().get("display_name"),parent_id:this.options.parent_id})},r.prototype.hideErrors=function(){return this.$el.find(".comment-message").hide()},r.prototype.showErrors=function(e){var t,n=this;return t="",t+="<ul>",_.map(e,function(e){return console.log(e),t+="<li>"+e.message+"</li>"}),t+="</ul>",this.$el.find(".comment-message").html(t).show()},r.prototype.events={"click .submit-comment":"submitComment","click .preview-comment":"previewComment","click .close-reply-form":"closeReplyForm"},r.prototype.submitComment=function(e){var t,n=this;return e.preventDefault(),this.updateModel(),this.model.isValid()?(this.hideErrors(),t={success:function(e,t){return n.showCommentSuccess(e),n.reset()},error:function(e,t){return t.status===405?n.showMaintanenceMessage():t.status===401?(Community.Models.User.clearStaleSessionCookies(),n.showLoginError()):n.showServerError()}},_gaq.push(["AllSites._trackEvent","Conversion","Comment Submit",Community.Config.page_title]),this.collection.create(this.model,_.extend({wait:!0},t))):this.showErrors(this.model.validationError)},r.prototype.previewComment=function(e){var t=this;return e.preventDefault(),this.updateModel(),this.model.isValid()?(this.hideErrors(),this.model.preview({success:this.showPreviewSuccess,error:function(e,n){return n.status===405?t.showMaintanenceMessage():n.status===401?(Community.Models.User.clearStaleSessionCookies(),t.showLoginError()):(console.log(n.status),t.showServerError())}})):this.showErrors(this.model.validationError)},r.prototype.updateModel=function(){return this.model.set({body:this.$el.find(".comment-body").val()})},r.prototype.showPreviewSuccess=function(){return this.$el.find(".comment-preview").html(this.previewTemplate(this.model.toJSON())).css({backgroundColor:"#FFFF00"}).show()},r.prototype.showCommentSuccess=function(e){var t;return this.options.parent_id?(this.$el.find(".comment-form").hide(),this.$el.find(".comment-preview").hide(),this.$el.find(".comment-message").hide(),t=$('*[data-id="'+e.get("id")+'"]'),$("html,body").animate({scrollTop:t.offset().top},"fast"),t.effect("highlight",{},2e3)):(this.$el.find(".comment-preview").hide(),this.$el.find(".comment-message").html("Your comment has been posted.").show())},r.prototype.showServerError=function(){var e;return e="",e+="<ul>",e+="<li>There's been an error on the server. Please try again in a few minutes.</li>",e+="</ul>",this.$el.find(".comment-message").html(e).show()},r.prototype.showLoginError=function(){var e;return e="",e+="<ul>",e+="<li>We're very sorry, but your session has expired. To post this comment you'll need to <a href=\"http://community.apartmenttherapy.com/sign_in\">sign back in</a>. <br><br>Before you go, you might want to copy your comment so you won't lose your work!</li>",e+="</ul>",this.$el.find(".comment-message").html(e).show()},r.prototype.showMaintanenceMessage=function(){var e;return e="",e+="<ul>",e+="<li>We're very sorry, but the comment system is undergoing maintanence. Please try back in a few minutes.</li>",e+="</ul>",this.$el.find(".comment-message").html(e).show()},r.prototype.closeReplyForm=function(e){return e.preventDefault(),this.$el.html("")},r.prototype.render=function(){return this.$el.html(this.template(this.model.toJSON())),this.options.parent_id&&this.$el.find(".new-comment").hide(),this},r}(Backbone.View)}.call(this),function(){var e,t,n=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty,i=function(e,t){function i(){this.constructor=e}for(var n in t)r.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};(e=Community.Views).Comments||(e.Comments={}),Community.Views.Comments.CommentView=function(e){function r(){return this.flagComment=n(this.flagComment,this),this.showFlags=n(this.showFlags,this),this.hideActions=n(this.hideActions,this),this.showActions=n(this.showActions,this),t=r.__super__.constructor.apply(this,arguments),t}return i(r,e),r.prototype.template=JST["backbone/templates/comments/comment"],r.prototype.className="article comment",r.prototype.attributes=function(){var e,t,n;return{"data-id":(e=this.model)!=null?e.get("id"):void 0,"data-parentId":(t=this.model)!=null?t.get("parent_id"):void 0,"data-userId":(n=this.model)!=null?n.get("user_id"):void 0}},r.prototype.events={mouseenter:"showActions",mouseleave:"hideActions","click .show_flag_comment_actions":"showFlags","click .flag_comment":"flagComment","click .reply_to_comment":"reply"},r.prototype.initialize=function(){return this.model.on("change",this.render,this),this.parentView=this.options.parentView},r.prototype.showActions=function(e){return $(this.el).find(".show_flag_comment_actions").fadeIn(50),$(this.el).find(".reply-button").fadeIn(50)},r.prototype.hideActions=function(e){return $(this.el).find(".show_flag_comment_actions").hide().siblings(".flag_comment_actions").hide(),$(this.el).find(".reply-button").hide()},r.prototype.showFlags=function(e){return e.preventDefault(),$(e.currentTarget).hide().siblings(".flag_comment_actions").show()},r.prototype.flagComment=function(e){var t,n,r,i=this;return e.preventDefault(),_gaq.push(["AllSites._trackEvent","Reader Action","Flagged Comment",Community.Config.page_title]),n=$(e.currentTarget).data("flag-type"),r=$(e.currentTarget).parent(),r.siblings(".flag_comment_actions, .show_flag_comment_actions").remove(),r.html("Sending..."),t={success:function(e){return r.replaceWith("<span>"+e.message+"</span>")},error:function(){var e;return e="help@apartmenttherapy.com",r.parent().replaceWith('<p> Oops, an error kept us from flagging that comment.  Please try again later. If the problem persists, contact us at  <a href="mailto:'+e+'">'+e+"</a>"+"</p>")}},this.model.flag(n,t.success,t.error)},r.prototype.reply=function(e){var t,n;return e.preventDefault(),Community.Models.User.loggedIn()?(this.hideActions(),t=new Community.Views.Comments.CommentFormView({el:this.$el.find(".comment-form"),collection:this.collection,commentable_id:this.parentView.commentableId,commentable_title:this.parentView.commentableTitle,commentable_type:this.parentView.commentableType,parent_id:this.model.get("id"),user_display_name:Community.Models.User.current().get("display_name")}),t.render()):(n=$(".login-message"),$("html,body").animate({scrollTop:n.offset().top},"fast"),n.effect("highlight",{},2e3))},r.prototype.render=function(){return this.markStaffAndAuthor(),$(this.el).html(this.template(this.model.toJSON())),this.hideActions(),this},r.prototype.markStaffAndAuthor=function(){var e;this.model.isStaff()&&$(this.el).addClass("staff accent-border-color");if(Community.Config.author_community_user_id&&Community.Config.author_community_user_id===parseInt((e=this.model)!=null?e.get("user_id"):void 0))return $(this.el).addClass("author")},r}(Backbone.View)}.call(this),function(){var e,t,n=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty,i=function(e,t){function i(){this.constructor=e}for(var n in t)r.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};(e=Community.Views).Comments||(e.Comments={}),Community.Views.Comments.CommentsView=function(e){function r(){return this.removeOne=n(this.removeOne,this),this.addOne=n(this.addOne,this),t=r.__super__.constructor.apply(this,arguments),t}return i(r,e),r.prototype.template=JST["backbone/templates/comments/comments"],r.prototype.initialize=function(){return this.collection=new Community.Collections.Comments(this.options.comments),this.collection.bind("add",this.addOne,this),this.collection.bind("reset",this.addAll,this),this.collection.bind("remove",this.removeOne,this),this.commentableId=this.options.commentable_id,this.commentableTitle=this.options.commentable_title,this.commentableType=this.options.commentable_type,this.commentViews=[]},r.prototype.refresh=function(){var e,t=this;return e={success:function(){return t.addAll}},this.collection.fetchCommentableComments(this.options.commentable_id,this.options.commentable_type,e)},r.prototype.render=function(){return this.$el.html(this.template()),this.handleLoggedInUser(),this.addAll()},r.prototype.updateCount=function(){var e;return e=$(".comment-link > b"),e.html(this.commentViews.length)},r.prototype.handleLoggedInUser=function(){var e;if(Community.Models.User.loggedIn())return e=new Community.Views.Comments.CommentFormView({el:this.$el.find(".comment-form"),collection:this.collection,commentable_id:this.commentableId,commentable_title:this.commentableTitle,commentable_type:this.commentableType,user_display_name:Community.Models.User.current().get("display_name")}),e.render(),this.$el.find(".login-message").hide()},r.prototype.addOne=function(e){var t;return t=new Community.Views.Comments.CommentView({model:e,collection:this.collection,parentView:this}),this.$el.find(".comments-container").append(t.render().el),this.commentViews.push(t),this.updateCount()},r.prototype.addAll=function(){var e,t=this;return this.$el.find(".comments-container").html(""),e=document.createDocumentFragment(),this.collection.each(function(n){var r;return r=new Community.Views.Comments.CommentView({model:n,collection:t.collection,parentView:t}),e.appendChild(r.render().el),t.commentViews.push(r)}),this.updateCount(),this.$el.find(".comments-container").append(e)},r.prototype.removeOne=function(e,t){var n;return n=this.findViewByComment(e),this.removeView(n),this.updateCount()},r.prototype.findViewByComment=function(e){return _.find(this.commentViews,function(t){return e.id===t.model.id})},r.prototype.removeView=function(e){var t;return e.remove(),t=this.commentViews.indexOf(e),this.commentViews.splice(t,1)},r}(Backbone.View)}.call(this),function(){var e,t,n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};(e=Community.Views).ContestEntries||(e.ContestEntries={}),Community.Views.ContestEntries.FavoriteButton=function(e){function n(){return t=n.__super__.constructor.apply(this,arguments),t}return r(n,e),n.prototype.tagName="span",n.prototype.className="favorite-button",n.prototype.template=JST["backbone/templates/contest_entries/favorite_button"],n.prototype.events={"click .favorite":"clickFavorite","mouseenter .favorite":"showTooltip","mouseout .favorite":"hideTooltip"},n.prototype.initialize=function(e){var t=this;return this.$el=$(this.el),this.user=Community.Models.User.current(),this.state="INITIALIZING",this.contest_entry_id=e.contest_entry_id,this.contest_human_id=e.contest_human_id,this.contest_entry_title=e.contest_entry_title,this.disabled=e.disabled||!1,this.$el.data("view",this).addClass("contest-entry-"+this.contest_entry_id),$.ajax({async:!1,url:Community.Config.proxy+("/contests/"+this.contest_human_id+"/entries/"+this.contest_entry_id+"/favorites_count.json"),context:this,success:function(e){return t.count=e.favorites_count}})},n.prototype.isFavorited=function(){return _.include(_.pluck(this.user.get("contest_entry_favorites"),"contest_entry_id"),this.contest_entry_id)},n.prototype.showFavoriteButton=function(){return this.$(".favorite").show()},n.prototype.hideFavoriteButton=function(){return this.$(".favorite").hide()},n.prototype.showFavorited=function(){return this.$(".favorite-count").addClass("favorited"),this.$(".already-favorited").show()},n.prototype.hideFavorited=function(){return this.$(".favorite-count").removeClass("favorited"),this.$(".already-favorited").hide()},n.prototype.setTooltip=function(e){return this.$el.find(".tooltip").addClass("active").find("span").hide().end().find("."+e).show()},n.prototype.deactivateTooltip=function(){return this.$el.find(".tooltip").removeClass("active").hide()},n.prototype.showTooltip=function(){return this.$el.find(".tooltip.active").fadeIn(100)},n.prototype.hideTooltip=function(){return this.$el.find(".tooltip").fadeOut(100)},n.prototype.incrementFavoriteCount=function(){return this.$(".favorite-count strong").html(this.count+1).effect("bounce",{direction:"up",times:3},250)},n.prototype.resetFavoriteCount=function(){return this.$(".favorite-count strong").html(this.count).stop()},n.prototype.clickFavorite=function(e){var t=this;e.preventDefault();switch(this.state){case"NO_USER":return window.location=Community.Config.host+"/sign_in?sign_out_first=1&return_to="+encodeURIComponent(window.location.href);case"UNCONFIRMED_USER":return window.location=this.user.editUrl()+"#highlight-confirm-account";case"CONFIRMED_USER":return this.$(e.target).attr("disabled",!0),$(".favorite-button.contest-entry-"+this.contest_entry_id).each(function(){var e;return e=$(this).data("view"),e.setState("ALREADY_FAVORITED"),e.incrementFavoriteCount()}),_gaq.push(["AllSites._trackEvent","Reader Action","Contest Vote",this.contest_entry_title]),$.ajax({type:"POST",url:Community.Config.proxy+("/contests/"+this.contest_human_id+"/entries/"+this.contest_entry_id+"/favorites.json"),error:function(e){var n;return t.setState("ERROR"),n=$.parseJSON(e.responseText),t.$(".favorite-errors").show().html(n.errors.base)}})}},n.prototype.setState=function(e){this.state=e;switch(e){case"NO_USER":return this.showFavoriteButton(),this.hideFavorited(),this.setTooltip(e);case"UNCONFIRMED_USER":return this.showFavoriteButton(),this.hideFavorited(),this.setTooltip(e);case"CONFIRMED_USER":return this.showFavoriteButton(),this.hideFavorited(),this.deactivateTooltip();case"ALREADY_FAVORITED":return this.hideFavoriteButton(),this.showFavorited(),this.deactivateTooltip();case"ERROR":return this.showFavoriteButton(),this.hideFavorited(),this.resetFavoriteCount(),this.setTooltip(e),this.showTooltip()}},n.prototype.render=function(){var e=this;return this.user?this.user.fetch({success:function(){return e._render()}}):this._render(),this},n.prototype._render=function(){return this.$el.html(this.template({contest_entry_id:this.contest_entry_id,count:this.count,disabled:this.disabled})),this.user?this.isFavorited()?this.setState("ALREADY_FAVORITED"):this.user.get("confirmed")?this.setState("CONFIRMED_USER"):this.setState("UNCONFIRMED_USER"):this.setState("NO_USER"),this},n}(Backbone.View)}.call(this),function(){var e,t,n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};(e=Community.Views).ContestEntries||(e.ContestEntries={}),Community.Views.ContestEntries.ShowView=function(e){function n(){return t=n.__super__.constructor.apply(this,arguments),t}return r(n,e),n.prototype.template=JST["backbone/templates/contest_entries/show"],n.prototype.initialize=function(){return this.user=Community.Models.User.current(),this.model=new Community.Models.ContestEntry({id:this.getContestEntryId(),contestHumanId:this.getContestHumanId()})},n.prototype.getContestEntryId=function(e){return e==null&&(e=this.el),$(e).data("entry-id")},n.prototype.getContestHumanId=function(e){return e==null&&(e=this.el),$(e).data("contest-human-id")},n.prototype.showLoginForm=function(){return this.$(".login-prompt").show()},n.prototype.hideLoginForm=function(){return this.$(".login-prompt").hide()},n.prototype.showConfirmMessage=function(){return this.$(".confirm-message").show()},n.prototype.updateConfirmMessageUrl=function(e){return this.$(".confirm-message a").attr("href",e)},n.prototype.hideConfirmMessage=function(){return this.$(".confirm-message").hide()},n.prototype.showStateMessage=function(){return this.$("."+this.model.get("contest_info").state+"-message").show()},n.prototype.render=function(){var e=this;return this.model.fetch({success:function(t,n){return $(e.el).html(e.template(t.toJSON())),e.user&&e.user.fetch({success:function(){return e.initConfirmMessage(e.user)}}),e.showStateMessage(),e.initLoginForm(e.user,e.model),$(e.el).find(".favorite-button-wrapper").html((new Community.Views.ContestEntries.FavoriteButton({contest_entry_id:e.model.id,contest_human_id:e.model.get("contest_info").human_id,contest_entry_title:e.model.get("title"),disabled:!t.isVotingRound()})).render().el),e}})},n.prototype.initLoginForm=function(e,t){return e||!t.isVotingRound()?this.hideLoginForm():this.showLoginForm()},n.prototype.initConfirmMessage=function(e){return e.get("confirmed")?this.hideConfirmMessage():(this.updateConfirmMessageUrl(e.editUrl()+"#highlight-confirm-account"),this.showConfirmMessage())},n}(Backbone.View)}.call(this),function(){var e,t,n=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty,i=function(e,t){function i(){this.constructor=e}for(var n in t)r.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};(e=Community.Views).Contests||(e.Contests={}),Community.Views.Contests.TopEntriesWidgetView=function(e){function r(){return this.selectedListChanged=n(this.selectedListChanged,this),t=r.__super__.constructor.apply(this,arguments),t}return i(r,e),r.prototype.template=JST["backbone/templates/contests/top_entries_widget"],r.prototype.entryListSelectTemplate=JST["backbone/templates/contests/entry_list_select"],r.prototype.widgetEntryTemplate=JST["backbone/templates/contests/widget_entry"],r.prototype.finalistsTemplate=JST["backbone/templates/contests/finalists"],r.prototype.winnersTemplate=JST["backbone/templates/contests/winners"],r.prototype.events={"change select":"selectedListChanged"},r.prototype.initialize=function(){return this.model=new Community.Models.Contest({human_id:this.getContestHumanId()})},r.prototype.getContestHumanId=function(e){return e==null&&(e=this.el),$(e).data("contest-human-id")},r.prototype.render=function(){var e=this;return this.model.fetch({success:function(t,n){return e.initializeWidget(t.toJSON())}})},r.prototype.initializeWidget=function(e){return $(this.el).html(this.template(e)),this.populateWidget(this.$(".widget-content"),e)},r.prototype.populateWidget=function(e,t){var n=this;e.html(this.contentForContestState(t)),_.each(t.entry_lists,function(e){return n.populateList(e)});if(this.model.get("state")==="favorites_round")return this.showSelectedList()},r.prototype.contentForContestState=function(e){switch(this.model.get("state")){case"favorites_round":return this.entryListSelectTemplate(e);case"finalist_voting_round":return this.finalistsTemplate(e);case"closed":return this.winnersTemplate(e)}},r.prototype.populateList=function(e){return this.$el.find(".entries-widget-list").prepend(this.widgetEntryTemplate(e))},r.prototype.showSelectedList=function(e){return e==null&&(e=null),e||(e=this.$("select").val()),$(this.el).find(".entries-widget-list-item").hide().filter('[data-list-name="division-'+e+'"]').show()},r.prototype.selectedListChanged=function(e){var t,n;t=e.currentTarget.value;if(!t)return;return n=$(this.el).find(".entries-widget-list-item").hide().filter('[data-list-name="division-'+t+'"]'),n.length>0?this.showSelectedList(t):this.fetchAndShowSelectedList(t)},r.prototype.fetchAndShowSelectedList=function(e){var t=this;return this.$el.find(".spinner").show(),this.model.fetchDivisionLeaders(e,function(n){return t.populateList(n),t.$el.find(".spinner").hide(),t.showSelectedList(e)})},r}(Backbone.View)}.call(this),function(){var e,t,n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};(e=Community.Views).GiveawayCollections||(e.GiveawayCollections={}),Community.Views.GiveawayCollections.GiveawayCollectionWidgetView=function(e){function n(){return t=n.__super__.constructor.apply(this,arguments),t}return r(n,e),n.prototype.template=JST["backbone/templates/giveaway_collections/giveaway_collections_widget"],n.prototype.initialize=function(){return this.model=new Community.Models.GiveawayCollection({human_id:this.getGiveawayCollectionHumanId()})},n.prototype.getGiveawayCollectionHumanId=function(e){return e==null&&(e=this.el),$(e).data("giveaway-collection-human-id")},n.prototype.render=function(){var e=this;return this.model.fetch({success:function(t,n){return $(e.el).html(e.template(n)),$(e.el).find(".giveaway-"+Community.currentSite()).show()}})},n}(Backbone.View)}.call(this),function(){var e,t,n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};(e=Community.Views).Nominations||(e.Nominations={}),Community.Views.Nominations.NominationCollectionView=function(e){function n(){return t=n.__super__.constructor.apply(this,arguments),t}return r(n,e),n.prototype.initialize=function(){return this.user=this.options.user,this.approvalBallot=this.options.approvalBallot,_(this).bindAll("add","remove"),this._nominationViews=[],this.collection.each(this.add),this.collection.bind("add",this.add),this.collection.bind("remove",this.remove)},n.prototype.add=function(e){var t;t=new Community.Views.Nominations.NominationView({model:e,user:this.user,approvalBallot:this.approvalBallot}),this._nominationViews.push(t);if(this._rendered)return $(this.el).append(t.render().el)},n.prototype.events={"click .destroy":"destroy"},n.prototype.destroy=function(){return this.model.destroy(),this.remove(),!1},n.prototype.render=function(){var e,t=this;return this._rendered=!0,e=$(this.el).html(),$(this.el).empty(),_(this._nominationViews).each(function(e){return $(t.el).append(e.render().el)}),$(this.el).append(e),this},n}(Backbone.View)}.call(this),function(){var e,t,n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=
t.prototype,e};(e=Community.Views).Nominations||(e.Nominations={}),Community.Views.Nominations.NominationView=function(e){function n(){return t=n.__super__.constructor.apply(this,arguments),t}return r(n,e),n.prototype.template=JST["backbone/templates/nominations/nomination"],n.prototype.tagName="div",n.prototype.initialize=function(){return this.user=this.options.user,this.approvalBallot=this.options.approvalBallot},n.prototype.tagName="tr",n.prototype.className="nomination",n.prototype.events={"click .vote":"vote"},n.prototype.vote=function(e){var t=this;return e.preventDefault(),_gaq.push(["AllSites._trackEvent","Reader Action","Homies Vote",this.approvalBallot.get("name")]),this.$(e.target).attr("disabled",!0),this.model.vote({success:function(){return t.hideVoteButton(),t.showFavorited(),t.$(".vote-count strong").html(t.model.get("favorites_count")+1).effect("bounce",{direction:"up",times:3},250)},error:function(e){var n;return n=$.parseJSON(e.responseText),t.$(".nomination-errors").show().html(n.errors.base)}})},n.prototype.getNominationId=function(e){return e==null&&(e=this),$(e).attr("id").substr(5)},n.prototype.showVoteButton=function(){return this.$(".vote").show()},n.prototype.hideVoteButton=function(){return this.$(".vote").hide()},n.prototype.isFavorited=function(){return _.include(_.map(this.user.get("favorites").models,function(e){return e.get("favoritable_id")}),this.model.id)},n.prototype.showFavorited=function(){return this.$(".favorited").show()},n.prototype.hideFavorited=function(){return this.$(".favorited").hide()},n.prototype.render=function(){return $(this.el).html(this.template(this.model.toJSON())),this.user?this.isFavorited()?(this.hideVoteButton(),this.showFavorited()):this.approvalBallot.attributes["closed?"]?(this.hideVoteButton(),this.hideFavorited()):(this.showVoteButton(),this.hideFavorited()):(this.hideVoteButton(),this.hideFavorited()),this},n}(Backbone.View)}.call(this),function(){var e,t,n=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty,i=function(e,t){function i(){this.constructor=e}for(var n in t)r.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};(e=Community.Views).Surveys||(e.Surveys={}),Community.Views.Surveys.SurveyForm=function(e){function r(){return this.enableVoteButton=n(this.enableVoteButton,this),this.showResults=n(this.showResults,this),this.submitVote=n(this.submitVote,this),t=r.__super__.constructor.apply(this,arguments),t}return i(r,e),r.prototype.template=JST["backbone/templates/surveys/survey_form"],r.prototype.surveyResultsTemplate=JST["backbone/templates/surveys/survey_results"],r.prototype.surveyLoginMessageTemplate=JST["backbone/templates/surveys/survey_login_message"],r.prototype.events={"submit .survey_form form":"submitVote","click .show-results":"showResults","click .radio input":"enableVoteButton"},r.prototype.initialize=function(){return this.model=new Community.Models.Survey({id:this.options.id})},r.prototype.render=function(){var e=this;return this.model.fetch({success:function(t,n){return $(e.el).html(e.template(t.toJSON())),e.initializeForm()}})},r.prototype.voteButton=function(){return $(this.el).find('.survey_form form input[type="submit"]')},r.prototype.showResultsButton=function(){return $(this.el).find(".survey_form .show-results")},r.prototype.resultsSection=function(){return $(this.el).find(".survey_results")},r.prototype.voteForm=function(){return $(this.el).find(".survey_form")},r.prototype.answerRadios=function(){return $(this.el).find(".survey_form form :radio")},r.prototype.initializeForm=function(){return this.voteButton().attr("disabled","disabled"),$(this.el).addClass("embedded-form-widget"),$(this.el).append(this.surveyResultsTemplate(this.model.toJSON())),this.updateConentForState(this.model.state())},r.prototype.updateConentForState=function(e){switch(e){case"not_logged_in":return this.showLoginMessage();case"not_voted":return this.enableVoting();case"voted":return this.hideVoteForm();case"closed":return this.showClosedMessage()}},r.prototype.showLoginMessage=function(){return this.answerRadios().attr("disabled","disabled"),this.showResultsButton().filter(":visible").length>0&&this.resultsSection().hide(),this.voteForm().after(this.surveyLoginMessageTemplate())},r.prototype.enableVoting=function(){this.answerRadios().removeAttr("disabled");if(this.showResultsButton().filter(":visible").length>0)return this.resultsSection().hide()},r.prototype.hideVoteForm=function(){return this.voteForm().hide()},r.prototype.showClosedMessage=function(){return this.hideVoteForm(),this.resultsSection().after("<div class='footer'>This survey has ended.</div>")},r.prototype.submitVote=function(e){var t,n=this;return e.preventDefault(),_gaq.push(["AllSites._trackEvent","Reader Action","Responed to Poll",Community.Config.page_title]),t=$('form input[name="position"]:checked').val(),this.model.vote(t,{success:function(e){return n.resultsSection().replaceWith(n.surveyResultsTemplate(e)),n.updateConentForState("voted"),n.resultsSection().after("<div class='footer'>Thank you, your survey vote has been recorded.</div>")},error:function(e){return e.status===405?n.showMaintanenceMessage():e.status===401?(Community.Models.User.clearStaleSessionCookies(),n.showLoginError()):n.voteForm().after("<div class='errors'>Sorry, an error prevented us from casting your vote.  Please try again later.</div>")}})},r.prototype.showLoginError=function(){var e;return e="",e+="<ul>",e+="<li>We're very sorry, but your session has expired. To vote in this survey you'll need to <a href=\"http://community.apartmenttherapy.com/sign_in\">sign back in</a>.",e+="</ul>",this.voteForm().after(e)},r.prototype.showMaintanenceMessage=function(){var e;return e="",e+="<ul>",e+="<li>We're very sorry, but the comment system is undergoing maintanence. Please try back in a few minutes.</li>",e+="</ul>",this.voteForm().after(e)},r.prototype.showResults=function(e){return this.resultsSection().show(),this.showResultsButton().hide(),e.preventDefault()},r.prototype.enableVoteButton=function(e){return this.voteButton().removeAttr("disabled")},r}(Backbone.View)}.call(this),function(){$(function(){var e,t=this;return $(".approval-ballot.admin .nomination .merge select").change(function(e){var t,n;if(confirm("Are you sure you want to merge this nomination?"))return n=$(e.currentTarget).attr("id").substr(11),t=$(e.currentTarget).val(),$.ajax({type:"PUT",dataType:"json",url:"/nominations/"+t+"/merge",data:{merge_with_id:n},success:function(){return $("#nomination-"+n).remove()}})}),e=function(){var e=this;return $(".approval-ballot.admin .nominations .queue").each(function(e,t){return $(t).find(".nomination").length>0?$(t).children("p").hide():$(t).children("p").show()})},$(".approval-ballot.admin .nomination .approve input[type=submit]").live("click",function(t){var n;return t.preventDefault(),n=$(t.currentTarget).parents(".nomination").attr("id").substr(11),$.ajax({type:"POST",dataType:"json",url:"/nominations/"+n+"/approve",success:function(){var t;return t=$("#nomination-"+n),t.find(".approve").hide(),t.find(".deny").show(),$(".nominations .approved").append(t.remove()),e()}})}),$(".approval-ballot.admin .nomination .deny input[type=submit]").live("click",function(t){var n;return t.preventDefault(),n=$(t.currentTarget).parents(".nomination").attr("id").substr(11),$.ajax({type:"POST",dataType:"json",url:"/nominations/"+n+"/deny",success:function(){var t;return t=$("#nomination-"+n),t.find(".deny").hide(),t.find(".approve").show(),$(".nominations .denied").append(t.remove()),e()}})}),$(".approval-ballot.admin .nomination .delete a").click(function(e){var t;t=$(e.currentTarget).attr("id").substr(7);if(confirm("Are you sure you want to delete this nomination?"))return $.ajax({type:"DELETE",dataType:"json",url:"/nominations/"+t,success:function(){return $("#nomination-"+t).remove()}})}),$(".approval-ballot-container").each(function(e,t){var n;return n=new Community.Views.ApprovalBallots.ApprovalBallotView({el:t}),n.render()})})}.call(this),function(){$(function(){var e=this;return $(".contest-widget").each(function(e,t){return(new Community.Views.ContestEntries.ShowView({el:t})).render()}),$(".contest-entry-favorite-button").each(function(e,t){var n;return n=$(t),n.html((new Community.Views.ContestEntries.FavoriteButton({contest_entry_id:n.data("contest-entry-id"),contest_human_id:n.data("contest-human-id")})).render().el)}),$(".contest-top-entries-widget").each(function(e,t){return(new Community.Views.Contests.TopEntriesWidgetView({el:t})).render()})})}.call(this),function(){var e=this;$(".giveaway-collections-widget").each(function(e,t){return(new Community.Views.GiveawayCollections.GiveawayCollectionWidgetView({el:t})).render()})}.call(this),function(){$(function(){return $(".survey_container").each(function(){var e,t;return t=$(this).attr("id").substr(7),e=new Community.Views.Surveys.SurveyForm({id:t,el:$(this)}),e.render()})})}.call(this),function(){$(function(){var e,t=this;return Community.Models.User.loggedIn()?(e=Community.Models.User.current(),_gaq.push(["AllSites._setCustomVar",4,"Logged In","Member",2]),$("#account-link").html("Profile"),$("#account-link").attr("href",Community.Config.host+"/users/"+e.get("id")),$("#account-link-container").addClass("logged-in")):($("#account-link").attr("href",Community.Config.host+"/sign_in?sign_out_first=1&return_to="+encodeURIComponent(window.location.href)),_gaq.push(["AllSites._setCustomVar",4,"Logged In","Anonymous",2])),$(".social-signin").click(function(e){return e.preventDefault(),$(".social-option").html("Or sign in with Facebook or Twitter"),$(".social").toggle(),$(".login .options").toggleClass("form-present")}),_gaq.push(["AllSites._trackEvent","Dummy","Dummy","Dummy",1,!0])})}.call(this);